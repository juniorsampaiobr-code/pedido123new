const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./GoogleMapComponent-B8gKMqEN.js","./tanstack-d4AvmB45.js","./vendor-CnEXr6gt.js","./index-BMmnflvd.js","./supabase-BZV_3FV3.js","./index-Dcexqmok.css"])))=>i.map(i=>d[i]);
import{j as u}from"./tanstack-d4AvmB45.js";import{R as A,r as g}from"./vendor-CnEXr6gt.js";import{I as M}from"./label-BbikT_kN.js";import{a as G,b as L,u as f}from"./index-BMmnflvd.js";import{_ as y}from"./supabase-BZV_3FV3.js";const I=s=>{let o=s.replace(/\D/g,"");return o.length>8&&(o=o.slice(0,8)),o.length>5&&(o=`${o.slice(0,5)}-${o.slice(5)}`),o},b=A.forwardRef(({className:s,value:o,onChange:n,...r},a)=>{const e=t=>{const i=t.target.value,d=I(i),c={...t,target:{...t.target,value:d}};n(c)};return u.jsx(M,{ref:a,type:"tel",className:G("w-full",s),placeholder:"00000-000",value:o,onChange:e,maxLength:9,...r})});b.displayName="ZipCodeInput";const O=g.lazy(()=>y(()=>import("./GoogleMapComponent-B8gKMqEN.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url).then(s=>({default:s.GoogleMapComponent}))),T=s=>{const{center:o,markerPosition:n,onMarkerDragEnd:r,zoom:a}=s,e=g.useMemo(()=>({lat:o[0],lng:o[1]}),[o]),t=g.useMemo(()=>({lat:n[0],lng:n[1]}),[n]);return u.jsx(g.Suspense,{fallback:u.jsx(L,{}),children:u.jsx(O,{center:e,markerPosition:t,onMarkerDragEnd:r,zoom:a})})},v=(s,o,n,r)=>{const e=(n-s)*(Math.PI/180),t=(r-o)*(Math.PI/180),i=Math.sin(e/2)*Math.sin(e/2)+Math.cos(s*(Math.PI/180))*Math.cos(n*(Math.PI/180))*Math.sin(t/2)*Math.sin(t/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},F=async s=>{const o=s.replace(/\s+/g," ").trim(),n="AIzaSyDLbTHiIeHXH690Tqvr_W5OgzX-XGgYcgY",r=new AbortController,a=setTimeout(()=>r.abort(),1e4);try{let e,t="Nominatim";if(n){t="Google Maps Geocoding";const c=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(o)}&key=${n}`;console.log("LOG: geocodeAddress - URL da API (Google):",c);const l=await fetch(c,{signal:r.signal});if(!l.ok)console.error("LOG: geocodeAddress (Google) - Resposta da API não OK. Status:",l.status);else{if(e=await l.json(),e.status==="OK"&&e.results&&e.results.length>0){const m=e.results[0].geometry.location,p=m.lat,h=m.lng;if(Number.isFinite(p)&&Number.isFinite(h))return console.log(`LOG: geocodeAddress (${t}) - Geocodificação bem-sucedida. Coordenadas:`,[p,h]),clearTimeout(a),{lat:p,lng:h}}console.warn(`LOG: geocodeAddress (Google) - Falha na busca. Status: ${e.status}. Tentando Nominatim.`)}}t="Nominatim";const i=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(o)}&limit=1&addressdetails=1`;console.log("LOG: geocodeAddress - URL da API (Nominatim):",i);const d=await fetch(i,{signal:r.signal,headers:{"User-Agent":"Pedido123-App/1.0 (https://juniorsampaiobr-code.github.io/pedido123new/)"}});if(!d.ok)return console.error("LOG: geocodeAddress (Nominatim) - Resposta da API não OK. Status:",d.status),null;if(e=await d.json(),e&&Array.isArray(e)&&e.length>0){const c=e[0],l=parseFloat(c.lat),m=parseFloat(c.lon);if(Number.isFinite(l)&&Number.isFinite(m))return console.log(`LOG: geocodeAddress (${t}) - Geocodificação bem-sucedida. Coordenadas:`,[l,m]),clearTimeout(a),{lat:l,lng:m}}return console.warn("LOG: geocodeAddress - Falha. Nenhum resultado encontrado ou coordenadas inválidas para:",o),f.error("Não foi possível encontrar o endereço. Verifique todos os campos e tente novamente."),null}catch(e){return e instanceof Error&&e.name==="AbortError"?(console.error("LOG: geocodeAddress - Timeout na requisição (10s). Endereço:",o),f.error("A requisição para encontrar o endereço demorou muito. Tente novamente.")):(console.error("LOG: geocodeAddress - Erro durante a requisição:",e),f.error("Ocorreu um erro ao buscar o endereço. Tente novamente.")),null}finally{clearTimeout(a)}},j=(s,o,n)=>{const r=v(o[0],o[1],s[0],s[1]),a=n.find(e=>r<=e.max_distance_km);if(a){const e=a.delivery_fee||0,t=a.min_delivery_time_minutes||0,i=t+15;return{fee:parseFloat(e.toFixed(2)),minTime:t,maxTime:i}}return null};export{T as L,b as Z,j as c,F as g};
