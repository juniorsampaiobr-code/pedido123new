import{j as e}from"./tanstack-D8i8yNxB.js";import{u as L,r as s}from"./vendor-Dl0Wzy4_.js";import{L as q}from"./Logo-B1JsGou_.js";import{B as v}from"./button-BgVjR-Xo.js";import{L as u,I as f}from"./label-kZKqoVUX.js";import{C as D,b as I,c as U,d as k,a as z}from"./card-CnlqtSz2.js";import{u as o}from"./index-DikNApWc.js";import{s as m}from"./client-BmrnLCXS.js";import{P as A}from"./PhoneInput-C4w2_nsz.js";import"./package-ChvlSiw2.js";import"./supabase-A1WgB1xz.js";const C=n=>n.replace(/\D/g,""),X=()=>{const n=L(),[x,d]=s.useState(!1),[l,b]=s.useState(!1),[c,S]=s.useState(""),[i,y]=s.useState(""),[h,w]=s.useState(""),[p,P]=s.useState(""),[O,g]=s.useState(null),[T,j]=s.useState(null);s.useEffect(()=>{const{data:{subscription:r}}=m.auth.onAuthStateChange((a,t)=>{j(t),g((t==null?void 0:t.user)??null),t!=null&&t.user&&n("/checkout")});return m.auth.getSession().then(({data:{session:a}})=>{j(a),g((a==null?void 0:a.user)??null),a!=null&&a.user&&n("/checkout")}),()=>r.unsubscribe()},[n]);const E=()=>h.trim()?C(p).length!==11?(o.error("O Telefone deve conter 11 dígitos (DDD + 9 dígitos)."),!1):c.trim()?i.length<6?(o.error("A Senha deve ter pelo menos 6 caracteres."),!1):!0:(o.error("O Email é obrigatório."),!1):(o.error("O Nome Completo é obrigatório."),!1),F=async r=>{r.preventDefault(),d(!0);try{if(l){if(!E()){d(!1);return}const a=C(p),{data:t,error:N}=await m.auth.signUp({email:c,password:i,options:{data:{full_name:h,phone:a}}});if(N)throw N;t.session?o.success("Conta criada e login efetuado com sucesso!"):o.success("Conta criada! Verifique seu email para confirmar.")}else{const{error:a}=await m.auth.signInWithPassword({email:c,password:i});if(a)throw a;o.success("Login realizado com sucesso!")}}catch(a){a.message.includes("Email not confirmed")?o.error("Por favor, verifique seu e-mail para confirmar sua conta antes de fazer login."):o.error(a.message||"Erro ao processar autenticação")}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"mb-8 text-center",children:e.jsx(q,{className:"justify-center mb-4"})}),e.jsxs(D,{className:"shadow-xl border-2",children:[e.jsxs(I,{className:"space-y-1",children:[e.jsx(U,{className:"text-2xl font-bold text-center",children:l?"Crie sua conta":"Acesse sua conta"}),e.jsx(k,{className:"text-center",children:l?"Preencha os campos para começar":"Utilize seu email e senha para fazer login"})]}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"fullName",children:"Nome Completo *"}),e.jsx(f,{id:"fullName",type:"text",placeholder:"Seu nome completo",value:h,onChange:r=>w(r.target.value),required:!0,className:"h-12"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"phone",children:"Telefone *"}),e.jsx(A,{id:"phone",value:p,onChange:r=>P(r.target.value),required:!0,className:"h-12"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Formato: (99) 99999-9999"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:"Email *"}),e.jsx(f,{id:"email",type:"email",placeholder:"seu@email.com",value:c,onChange:r=>S(r.target.value),required:!0,className:"h-12"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"password",children:"Senha *"}),e.jsx(f,{id:"password",type:"password",placeholder:"••••••••",value:i,onChange:r=>y(r.target.value),required:!0,className:"h-12"})]}),e.jsx(v,{type:"submit",className:"w-full",size:"lg",disabled:x,children:x?"Processando...":l?"Criar conta":"Entrar"})]}),e.jsx("div",{className:"text-center",children:e.jsx(v,{variant:"link",type:"button",className:"p-0 h-auto",onClick:()=>b(!l),children:l?"Já tem uma conta? Faça login":"Não tem uma conta? Crie uma agora"})})]})]})]})})};export{X as default};
