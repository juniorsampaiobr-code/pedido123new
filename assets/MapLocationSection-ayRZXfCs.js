const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LocationPickerMap-CyI-GYda.js","./tanstack-D8i8yNxB.js","./vendor-Dl0Wzy4_.js","./LocationPickerMap-Dgihpmma.css"])))=>i.map(i=>d[i]);
import{j as e}from"./tanstack-D8i8yNxB.js";import{R as L,r as l}from"./vendor-Dl0Wzy4_.js";import{I as b}from"./label-CS38kCSE.js";import{b as z,v as A,u as o}from"./index-CWc58bZs.js";import{A as h,a as j,b as g}from"./alert-Brw8yoR2.js";import{_ as E}from"./supabase-A1WgB1xz.js";import{M as v}from"./map-pin-Cu4jiziQ.js";const M=s=>{let a=s.replace(/\D/g,"");return a.length>8&&(a=a.slice(0,8)),a.length>5&&(a=`${a.slice(0,5)}-${a.slice(5)}`),a},_=L.forwardRef(({className:s,value:a,onChange:n,...p},c)=>{const r=t=>{const u=t.target.value,i=M(u),m={...t,target:{...t.target,value:i}};n(m)};return e.jsx(b,{ref:c,type:"tel",className:z("w-full",s),placeholder:"00000-000",value:a,onChange:r,maxLength:9,...p})});_.displayName="ZipCodeInput";const C=l.lazy(()=>E(()=>import("./LocationPickerMap-CyI-GYda.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),I=s=>e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"h-96 w-full rounded-lg bg-muted flex items-center justify-center",children:e.jsx(A,{})}),children:e.jsx(C,{...s})}),R=({markerPosition:s,onLocationChange:a,updateAddressFields:n,restaurant:p,mapKey:c})=>{const r=s[0],t=s[1],[u,i]=l.useState(!1);return l.useCallback(async(w,y)=>{i(!0);const N=o.loading("Buscando endereço para a nova localização...");try{const d=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${w}&lon=${y}&addressdetails=1`,x=await fetch(d);if(!x.ok)throw new Error("Falha ao obter detalhes do endereço.");const f=await x.json();f.address?(n(f.address),o.success("Endereço atualizado a partir do mapa.")):o.warning("Não foi possível encontrar um endereço para esta localização.")}catch(d){o.error(`Erro ao buscar endereço: ${d.message}`)}finally{i(!1),o.dismiss(N)}},[n]),Number.isFinite(r)&&Number.isFinite(t)?e.jsxs("div",{className:"space-y-2 relative",children:[e.jsx("div",{className:"relative",children:e.jsx(I,{center:s,markerPosition:s,onLocationChange:a,isInteractive:!0},c)}),e.jsxs("div",{className:"text-xs text-muted-foreground flex justify-between",children:[e.jsxs("span",{children:["Latitude: ",r==null?void 0:r.toFixed(6)]}),e.jsxs("span",{children:["Longitude: ",t==null?void 0:t.toFixed(6)]})]}),e.jsxs(h,{variant:"default",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx(j,{children:"Ajuste a Localização"}),e.jsx(g,{children:"Arraste o pino azul para o local exato da entrega para garantir a precisão da taxa."})]})]}):e.jsxs(h,{variant:"default",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx(j,{children:"Aguardando Localização"}),e.jsx(g,{children:"Aguarde o salvamento do endereço para visualizar o mapa."})]})},T=L.memo(R);export{T as M,_ as Z};
