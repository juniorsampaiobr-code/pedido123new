import{j as S}from"./tanstack-d4AvmB45.js";import{g as k,r as v,c as P}from"./vendor-CnEXr6gt.js";import{b as F,u as U}from"./index-Bx3OuksY.js";import"./supabase-BZV_3FV3.js";var j={exports:{}};function G(s,e,t,r){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function u(l){try{c(r.next(l))}catch(h){o(h)}}function n(l){try{c(r.throw(l))}catch(h){o(h)}}function c(l){l.done?i(l.value):a(l.value).then(u,n)}c((r=r.apply(s,[])).next())})}function M(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var _,C;function N(){return C||(C=1,_=function s(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,a,i;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(a=r;a--!==0;)if(!s(e[a],t[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[a]))return!1;for(a=r;a--!==0;){var o=i[a];if(!s(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}),_}var $=N(),q=M($);const A="__googleMapsScriptId";var y;(function(s){s[s.INITIALIZED=0]="INITIALIZED",s[s.LOADING=1]="LOADING",s[s.SUCCESS=2]="SUCCESS",s[s.FAILURE=3]="FAILURE"})(y||(y={}));class m{constructor({apiKey:e,authReferrerPolicy:t,channel:r,client:a,id:i=A,language:o,libraries:u=[],mapIds:n,nonce:c,region:l,retries:h=3,url:d="https://maps.googleapis.com/maps/api/js",version:g}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=r,this.client=a,this.id=i||A,this.language=o,this.libraries=u,this.mapIds=n,this.nonce=c,this.region=l,this.retries=h,this.url=d,this.version=g,m.instance){if(!q(this.options,m.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(m.instance.options)}`);return m.instance}m.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?y.FAILURE:this.done?y.SUCCESS:this.loading?y.LOADING:y.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(r=>{r?t(r.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,t;if(document.getElementById(this.id)){this.callback();return}const r={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(r).forEach(i=>!r[i]&&delete r[i]),!((t=(e=window==null?void 0:window.google)===null||e===void 0?void 0:e.maps)===null||t===void 0)&&t.importLibrary||(i=>{let o,u,n,c="The Google Maps JavaScript API",l="google",h="importLibrary",d="__ib__",g=document,f=window;f=f[l]||(f[l]={});const p=f.maps||(f.maps={}),E=new Set,b=new URLSearchParams,R=()=>o||(o=new Promise((I,w)=>G(this,void 0,void 0,function*(){var L;yield u=g.createElement("script"),u.id=this.id,b.set("libraries",[...E]+"");for(n in i)b.set(n.replace(/[A-Z]/g,D=>"_"+D[0].toLowerCase()),i[n]);b.set("callback",l+".maps."+d),u.src=this.url+"?"+b,p[d]=I,u.onerror=()=>o=w(Error(c+" could not load.")),u.nonce=this.nonce||((L=g.querySelector("script[nonce]"))===null||L===void 0?void 0:L.nonce)||"",g.head.append(u)})));p[h]?console.warn(c+" only loads once. Ignoring:",i):p[h]=(I,...w)=>E.add(I)&&R().then(()=>p[h](I,...w))})(r);const a=this.libraries.map(i=>this.importLibrary(i));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),i=>{const o=new ErrorEvent("error",{error:i});this.loadErrorCallback(o)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const t=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const x=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_ID:A,Loader:m,get LoaderStatus(){return y}},Symbol.toStringTag,{value:"Module"})),T=k(x);(function(s,e){(function(t,r){r(e,T,v)})(P,function(t,r,a){function i(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var o=i(a);t.Status=void 0,function(n){n.LOADING="LOADING",n.FAILURE="FAILURE",n.SUCCESS="SUCCESS"}(t.Status||(t.Status={}));const u=({children:n,render:c,callback:l,...h})=>{const[d,g]=a.useState(t.Status.LOADING);return a.useEffect(()=>{const f=new r.Loader(h),p=E=>{l&&l(E,f),g(E)};p(t.Status.LOADING),f.load().then(()=>p(t.Status.SUCCESS),()=>p(t.Status.FAILURE))},[]),d===t.Status.SUCCESS&&n?o.default.createElement(o.default.Fragment,null,n):c?c(d):o.default.createElement(o.default.Fragment,null)};t.Wrapper=u,Object.defineProperty(t,"__esModule",{value:!0})})})(j,j.exports);var O=j.exports;const K=({center:s,markerPosition:e,onMarkerDragEnd:t,zoom:r,className:a})=>{const i=v.useRef(null),o=v.useRef(null),u=v.useRef(null);return v.useEffect(()=>{if(!i.current)return;const n=new google.maps.Map(i.current,{center:s,zoom:r});o.current=n;const c=new google.maps.Marker({position:e,map:n,draggable:!0});return u.current=c,c.addListener("dragend",()=>{const l=c.getPosition();l&&t(l.lat(),l.lng())}),()=>{google.maps.event.clearInstanceListeners(n),google.maps.event.clearInstanceListeners(c),c.setMap(null)}},[]),v.useEffect(()=>{if(u.current&&o.current){const n=new google.maps.LatLng(e.lat,e.lng);u.current.setPosition(n),o.current.setCenter(n),o.current.setZoom(r)}},[e,r,s]),S.jsx("div",{ref:i,className:a,style:{height:"100%",width:"100%"}})},Z=s=>s===O.Status.LOADING?S.jsx(F,{}):s===O.Status.FAILURE?(U.error("Falha ao carregar o Google Maps. Verifique a chave de API."),S.jsx("div",{className:"flex items-center justify-center h-full text-destructive",children:"Erro ao carregar o mapa."})):null,B=s=>S.jsx(O.Wrapper,{apiKey:"AIzaSyDLbTHiIeHXH690Tqvr_W5OgzX-XGgYcgY",render:Z,libraries:["places"],children:S.jsx(K,{...s})});export{B as GoogleMapComponent};
