const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./GoogleMapComponent-Cs7yBAA0.js","./tanstack-d4AvmB45.js","./vendor-CnEXr6gt.js"])))=>i.map(i=>d[i]);
import{_ as g}from"./supabase-BZV_3FV3.js";import{j as u}from"./tanstack-d4AvmB45.js";import{r as l}from"./vendor-CnEXr6gt.js";import{b as p,u as d}from"./index-IwWOHj7_.js";const f=l.lazy(()=>g(()=>import("./GoogleMapComponent-Cs7yBAA0.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(n=>({default:n.GoogleMapComponent}))),L=n=>{const{center:r,markerPosition:t,onMarkerDragEnd:o,zoom:s}=n,e=l.useMemo(()=>({lat:r[0],lng:r[1]}),[r]),a=l.useMemo(()=>({lat:t[0],lng:t[1]}),[t]);return u.jsx(l.Suspense,{fallback:u.jsx(p,{}),children:u.jsx(f,{center:e,markerPosition:a,onMarkerDragEnd:o,zoom:s})})},h=(n,r,t,o)=>{const e=(t-n)*(Math.PI/180),a=(o-r)*(Math.PI/180),i=Math.sin(e/2)*Math.sin(e/2)+Math.cos(n*(Math.PI/180))*Math.cos(t*(Math.PI/180))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},T=async n=>{if(typeof google>"u"||!google.maps)return console.error("Google Maps SDK não carregado"),d.error("Serviço de mapa não disponível. Tente novamente."),null;const r=n.replace(/\s+/g," ").trim(),t=new google.maps.Geocoder;return new Promise(o=>{const s=setTimeout(()=>{console.error("Timeout na requisição de geocodificação"),d.error("A requisição para encontrar o endereço demorou muito. Tente novamente."),o(null)},1e4);t.geocode({address:r,componentRestrictions:{country:"BR"}},(e,a)=>{if(clearTimeout(s),a==="OK"&&e&&e.length>0){const i=e[0].geometry.location,c=i.lat(),m=i.lng();if(Number.isFinite(c)&&Number.isFinite(m)){console.log("LOG: geocodeAddress (Google Maps Service) - Geocodificação bem-sucedida. Coordenadas:",[c,m]),o({lat:c,lng:m});return}}console.warn(`LOG: geocodeAddress (Google Maps Service) - Falha na busca. Status: ${a}. Endereço: ${r}`),M(r).then(o)})})},M=async n=>{const r=new AbortController,t=setTimeout(()=>r.abort(),1e4);try{const o=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(n)}&limit=1&addressdetails=1`;console.log("LOG: geocodeAddress - URL da API (Nominatim):",o);const s=await fetch(o,{signal:r.signal,headers:{"User-Agent":"Pedido123-App/1.0 (https://juniorsampaiobr-code.github.io/pedido123new/)"}});if(!s.ok)return console.error("LOG: geocodeAddress (Nominatim) - Resposta da API não OK. Status:",s.status),null;const e=await s.json();if(e&&Array.isArray(e)&&e.length>0){const a=e[0],i=parseFloat(a.lat),c=parseFloat(a.lon);if(Number.isFinite(i)&&Number.isFinite(c))return console.log("LOG: geocodeAddress (Nominatim) - Geocodificação bem-sucedida. Coordenadas:",[i,c]),clearTimeout(t),{lat:i,lng:c}}return console.warn("LOG: geocodeAddress (Nominatim) - Falha. Nenhum resultado encontrado ou coordenadas inválidas para:",n),d.error("Não foi possível encontrar o endereço. Verifique todos os campos e tente novamente."),null}catch(o){return o instanceof Error&&o.name==="AbortError"?(console.error("LOG: geocodeAddress (Nominatim) - Timeout na requisição (10s). Endereço:",n),d.error("A requisição para encontrar o endereço demorou muito. Tente novamente.")):(console.error("LOG: geocodeAddress (Nominatim) - Erro durante a requisição:",o),d.error("Ocorreu um erro ao buscar o endereço. Tente novamente.")),null}finally{clearTimeout(t)}},y=(n,r,t)=>{const o=h(r[0],r[1],n[0],n[1]),s=t.find(e=>o<=e.max_distance_km);if(s){const e=s.delivery_fee||0,a=s.min_delivery_time_minutes||0,i=a+15;return{fee:parseFloat(e.toFixed(2)),minTime:a,maxTime:i}}return null};export{L,y as c,T as g};
