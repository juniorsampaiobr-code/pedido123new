import{b as pe,j as e,u as nt,c as Fe}from"./tanstack-d4AvmB45.js";import{r as l,u as ot,h as st,j as at,L as Me}from"./vendor-CnEXr6gt.js";import{s as P}from"./client-D5i5GwB9.js";import{c as it,d as yr,e as Ve,P as Ce,f as ke,g as ct,h as lt,i as dt,a as xe,u as S,L as he,p as ut,b as sr}from"./index-BBsjm8sm.js";import{L as mt,g as ar,c as Oe,Z as ft}from"./location-nsKPAXKA.js";import{u as pt}from"./use-auth-status-b07NBuTX.js";import{o as jr,s as L,e as ht,u as ir,C as fe,t as cr}from"./types-DKlirIXB.js";import{B as H}from"./button-BRNbqPhd.js";import{C as J,b as Q,c as X,a as W}from"./card-C7bg-nz9.js";import{L as O,I as se}from"./label-ZSdIsRno.js";import{T as xt}from"./textarea-37bvOMzi.js";import{c as vr,R as gt,I as yt}from"./index-ejSZwsz3.js";import{u as jt}from"./index-DrlxvCXN.js";import{u as vt}from"./index-KNP7Yozt.js";import{S as lr}from"./separator-CtmjnE3r.js";import{A as re,a as ae,b as ie}from"./alert-Cvh03ZWz.js";import{P as wt,M as bt}from"./PhoneInput-CPx4Bpzs.js";import{C as _t,L as Nt}from"./CustomerProfileModal-DCHNqlet.js";import{D as dr,a as ur,b as Ct,c as Et,d as St}from"./dialog-1MJutG2m.js";import{C as wr}from"./credit-card-rtbmBxsF.js";import{C as Pt}from"./CpfCnpjInput-BZKHrq1n.js";import{M as Te}from"./map-pin-FBOZzUk7.js";import{A as Rt,a as It,b as At,c as $t,d as Dt,e as Ft,g as Mt}from"./alert-dialog-BM41gxqD.js";import{C as _e}from"./circle-alert-AU3-EKRu.js";import{F as mr,b as Ot,d as kt}from"./form-yUQT00GK.js";import{T as fr}from"./terminal-BjBdbKLc.js";import{R as Tt}from"./pt-BR-KDBkhT8U.js";import{A as Lt}from"./arrow-left-BzRCeiW2.js";import{U as pr}from"./user-fMulGZsp.js";import{T as we}from"./truck-PRJSwC1l.js";import{C as Vt}from"./circle-check-big-DooeH-hP.js";import{S as zt}from"./save-CNFE7i7_.js";import{D as qt}from"./dollar-sign-DOAqCh96.js";import"./supabase-BZV_3FV3.js";import"./skeleton-C-7FBjE3.js";import"./store-Cfa_tZJP.js";import"./package-Deg6G3Di.js";import"./check-CvZSy3om.js";import"./circle-x-hReqz7qz.js";import"./euro-CElo9kiP.js";import"./format-BeKxgCCE.js";import"./index-BJNlIiDs.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=it("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Bt=async n=>{const{data:r,error:o}=await P.from("payment_settings").select("mercado_pago_public_key").eq("restaurant_id",n).limit(1).single();if(o&&o.code!=="PGRST116")throw new Error(`Error fetching payment settings: ${o.message}`);return(r==null?void 0:r.mercado_pago_public_key)||null},br=n=>pe({queryKey:["mercadoPagoPublicKey",n],queryFn:()=>Bt(n),enabled:!!n,staleTime:1/0});var ze="Radio",[Kt,_r]=yr(ze),[Ut,Zt]=Kt(ze),Nr=l.forwardRef((n,r)=>{const{__scopeRadio:o,name:u,checked:h=!1,required:g,disabled:_,value:c="on",onCheck:R,form:I,...C}=n,[y,D]=l.useState(null),E=Ve(r,G=>D(G)),A=l.useRef(!1),k=y?I||!!y.closest("form"):!0;return e.jsxs(Ut,{scope:o,checked:h,disabled:_,children:[e.jsx(Ce.button,{type:"button",role:"radio","aria-checked":h,"data-state":Pr(h),"data-disabled":_?"":void 0,disabled:_,value:c,...C,ref:E,onClick:ke(n.onClick,G=>{h||R==null||R(),k&&(A.current=G.isPropagationStopped(),A.current||G.stopPropagation())})}),k&&e.jsx(Sr,{control:y,bubbles:!A.current,name:u,value:c,checked:h,required:g,disabled:_,form:I,style:{transform:"translateX(-100%)"}})]})});Nr.displayName=ze;var Cr="RadioIndicator",Er=l.forwardRef((n,r)=>{const{__scopeRadio:o,forceMount:u,...h}=n,g=Zt(Cr,o);return e.jsx(ct,{present:u||g.checked,children:e.jsx(Ce.span,{"data-state":Pr(g.checked),"data-disabled":g.disabled?"":void 0,...h,ref:r})})});Er.displayName=Cr;var Ht="RadioBubbleInput",Sr=l.forwardRef(({__scopeRadio:n,control:r,checked:o,bubbles:u=!0,...h},g)=>{const _=l.useRef(null),c=Ve(_,g),R=vt(o),I=lt(r);return l.useEffect(()=>{const C=_.current;if(!C)return;const y=window.HTMLInputElement.prototype,E=Object.getOwnPropertyDescriptor(y,"checked").set;if(R!==o&&E){const A=new Event("click",{bubbles:u});E.call(C,o),C.dispatchEvent(A)}},[R,o,u]),e.jsx(Ce.input,{type:"radio","aria-hidden":!0,defaultChecked:o,...h,tabIndex:-1,ref:c,style:{...h.style,...I,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Sr.displayName=Ht;function Pr(n){return n?"checked":"unchecked"}var Jt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ee="RadioGroup",[Qt,uo]=yr(Ee,[vr,_r]),Rr=vr(),Ir=_r(),[Xt,Wt]=Qt(Ee),Ar=l.forwardRef((n,r)=>{const{__scopeRadioGroup:o,name:u,defaultValue:h,value:g,required:_=!1,disabled:c=!1,orientation:R,dir:I,loop:C=!0,onValueChange:y,...D}=n,E=Rr(o),A=jt(I),[k,G]=dt({prop:g,defaultProp:h??null,onChange:y,caller:Ee});return e.jsx(Xt,{scope:o,name:u,required:_,disabled:c,value:k,onValueChange:G,children:e.jsx(gt,{asChild:!0,...E,orientation:R,dir:A,loop:C,children:e.jsx(Ce.div,{role:"radiogroup","aria-required":_,"aria-orientation":R,"data-disabled":c?"":void 0,dir:A,...D,ref:r})})})});Ar.displayName=Ee;var $r="RadioGroupItem",Dr=l.forwardRef((n,r)=>{const{__scopeRadioGroup:o,disabled:u,...h}=n,g=Wt($r,o),_=g.disabled||u,c=Rr(o),R=Ir(o),I=l.useRef(null),C=Ve(r,I),y=g.value===h.value,D=l.useRef(!1);return l.useEffect(()=>{const E=k=>{Jt.includes(k.key)&&(D.current=!0)},A=()=>D.current=!1;return document.addEventListener("keydown",E),document.addEventListener("keyup",A),()=>{document.removeEventListener("keydown",E),document.removeEventListener("keyup",A)}},[]),e.jsx(yt,{asChild:!0,...c,focusable:!_,active:y,children:e.jsx(Nr,{disabled:_,required:g.required,checked:y,...R,...h,name:g.name,ref:C,onCheck:()=>g.onValueChange(h.value),onKeyDown:ke(E=>{E.key==="Enter"&&E.preventDefault()}),onFocus:ke(h.onFocus,()=>{var E;D.current&&((E=I.current)==null||E.click())})})})});Dr.displayName=$r;var Yt="RadioGroupIndicator",Fr=l.forwardRef((n,r)=>{const{__scopeRadioGroup:o,...u}=n,h=Ir(o);return e.jsx(Er,{...h,...u,ref:r})});Fr.displayName=Yt;var Mr=Ar,Or=Dr,en=Fr;const Le=l.forwardRef(({className:n,...r},o)=>e.jsx(Mr,{className:xe("grid gap-2",n),...r,ref:o}));Le.displayName=Mr.displayName;const Ne=l.forwardRef(({className:n,...r},o)=>e.jsx(Or,{ref:o,className:xe("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),...r,children:e.jsx(en,{className:"flex items-center justify-center",children:e.jsx(Gt,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Ne.displayName=Or.displayName;var qe={};Object.defineProperty(qe,"__esModule",{value:!0});var kr=qe.loadMercadoPago=void 0;const Tr="https://sdk.mercadopago.com/js/v2",rn=/^https:\/\/sdk\.mercadopago\.com\/js\/v2\/?(\?.*)?$/,hr="MercadoPago has already been initialized in your window, please remove the duplicate import",tn="MercadoPago.js not available",nn="Failed to load MercadoPago.js",on=()=>{for(var n=document.querySelectorAll(`script[src^="${Tr}"`),r=0;r<n.length;r++){var o=n[r];if(rn.test(o.src))return o}return null},sn=()=>{const n=document.createElement("script");n.src=Tr;const r=document.head||document.body;if(!r)throw new Error("Expected document.body or document.head not to be null. MercadoPago requires a <body> or a <head> element, please add on your project.");return r.appendChild(n),n};let be=null;const an=()=>(be!==null||(be=new Promise((n,r)=>{if(typeof window>"u"){n(null);return}if(window.MercadoPago){console.warn(hr),n(window.MercadoPago);return}try{let o=on();o?console.warn(hr):o||(o=sn()),o.addEventListener("load",()=>{window.MercadoPago?n(window.MercadoPago):r(new Error(tn))}),o.addEventListener("error",()=>{r(new Error(nn))})}catch(o){r(o);return}})),be);kr=qe.loadMercadoPago=an;var cn=function(n,r,o,u){function h(g){return g instanceof o?g:new o(function(_){_(g)})}return new(o||(o=Promise))(function(g,_){function c(C){try{I(u.next(C))}catch(y){_(y)}}function R(C){try{I(u.throw(C))}catch(y){_(y)}}function I(C){C.done?g(C.value):h(C.value).then(c,R)}I((u=u.apply(n,r||[])).next())})};class K{static getInstance(){return cn(this,void 0,void 0,function*(){if(this.publicKey)return this.loadedInstanceMercadoPago||(yield kr(),this.loadedInstanceMercadoPago=!0),this.instanceMercadoPago||(this.instanceMercadoPago=new window.MercadoPago(this.publicKey,this.options)),this.instanceMercadoPago;console.error("Expected the PUBLIC_KEY to render the MercadoPago SDK React")})}}K.publicKey=null;K.options={};K.instanceMercadoPago=void 0;K.loadedInstanceMercadoPago=!1;function ln(n,r){return Object.keys(n).length===Object.keys(r).length&&Object.keys(n).every(u=>Object.prototype.hasOwnProperty.call(r,u)&&n[u]===r[u])}const dn=(n,r)=>{const o=Object.assign(Object.assign({},r),{frontEndStack:"react"}),u=!ln(K.options,o);(n!==K.publicKey||u)&&(K.publicKey=n,K.options=o,K.instanceMercadoPago=void 0)},un=({preferenceId:n,initPoint:r,onClose:o})=>{const{data:u,isLoading:h}=br();return l.useEffect(()=>{if(u)try{dn(u,{locale:"pt-BR"})}catch(g){console.error("Erro ao inicializar Mercado Pago:",g),S.error("Erro ao carregar o SDK do Mercado Pago."),o();return}r&&(console.log("Redirecionando para o Mercado Pago:",r),window.location.href=r)},[u,o,r]),h||!u?e.jsx(dr,{open:!0,onOpenChange:o,children:e.jsx(ur,{className:"sm:max-w-[425px]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[e.jsx(he,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{children:"Carregando configurações de pagamento..."})]})})}):e.jsx(dr,{open:!0,onOpenChange:o,children:e.jsxs(ur,{className:"sm:max-w-[425px]",children:[e.jsxs(Ct,{children:[e.jsxs(Et,{className:"flex items-center gap-2",children:[e.jsx(wr,{className:"h-5 w-5 text-primary"}),"Redirecionando para Pagamento"]}),e.jsx(St,{children:"Você está sendo redirecionado para o checkout seguro do Mercado Pago."})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(he,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aguarde..."})]}),e.jsx(H,{variant:"outline",onClick:o,children:"Cancelar e Voltar"})]})})},mn=({latitude:n,longitude:r,address:o,className:u})=>{const h=l.useMemo(()=>[n,r],[n,r]),g=l.useMemo(()=>[n,r],[n,r]);return e.jsxs(J,{className:xe("w-full",u),children:[e.jsxs(Q,{children:[e.jsxs(X,{className:"text-lg flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"}),"Sua Localização"]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:o})]}),e.jsx(W,{className:"p-0",children:e.jsx("div",{className:"h-64 w-full rounded-b-lg overflow-hidden",children:e.jsx(mt,{center:g,markerPosition:h,onMarkerDragEnd:()=>{},zoom:16})})})]})},fn=({isOpen:n,onConfirm:r})=>e.jsx(Rt,{open:n,children:e.jsxs(It,{children:[e.jsxs(At,{children:[e.jsxs($t,{className:"flex items-center gap-2 text-primary",children:[e.jsx(_e,{className:"h-6 w-6"}),"Atenção ao Pagamento Online!"]}),e.jsxs(Dt,{children:["Você escolheu o pagamento online (Pix ou Cartão).",e.jsx("br",{}),e.jsx("br",{}),"Ao prosseguir, você será redirecionado para o checkout do Mercado Pago.",e.jsx("br",{}),e.jsx("br",{}),'**IMPORTANTE:** Se você escolher **PIX**, após o pagamento, você pode precisar clicar no botão **"Voltar ao site"** na tela do Mercado Pago para que seu pedido seja finalizado e rastreado corretamente.']})]}),e.jsx(Ft,{children:e.jsx(Mt,{onClick:r,className:"w-full",children:"Entendi e Continuar"})})]})}),xr=n=>{if(!n)return"";let r=n.replace(/\D/g,"");return r.length>11&&(r=r.slice(0,11)),r.length>0&&(r=`(${r}`),r.length>3&&(r=`${r.slice(0,3)}) ${r.slice(3)}`),r.length>10&&(r=`${r.slice(0,10)}-${r.slice(10)}`),r},gr=n=>{if(!n)return"";let r=n.replace(/\D/g,"");return r.length>14&&(r=r.slice(0,14)),r.length<=11?(r.length>9&&(r=`${r.slice(0,9)}-${r.slice(9)}`),r.length>6&&(r=`${r.slice(0,6)}.${r.slice(6)}`),r.length>3&&(r=`${r.slice(0,3)}.${r.slice(3)}`)):(r.length>12&&(r=`${r.slice(0,12)}-${r.slice(12)}`),r.length>8&&(r=`${r.slice(0,8)}/${r.slice(8)}`),r.length>5&&(r=`${r.slice(0,5)}.${r.slice(5)}`),r.length>2&&(r=`${r.slice(0,2)}.${r.slice(2)}`)),r},pn=jr({zip_code:L().min(1,"CEP é obrigatório.").transform(n=>n.replace(/\D/g,"")).refine(n=>n.length===8,{message:"CEP deve ter 8 dígitos."}),street:L().min(1,"Rua é obrigatória."),number:L().min(1,"Número é obrigatório."),neighborhood:L().min(1,"Bairro é obrigatório."),city:L().min(1,"Cidade é obrigatória.")}),hn=jr({name:L().min(1,"Nome é obrigatório."),phone:L().min(1,"Telefone é obrigatório.").transform(n=>n.replace(/\D/g,"")).refine(n=>n.length>=10,{message:"O telefone deve ter pelo menos 10 dígitos."}),cpf_cnpj:L().min(1,"CPF/CNPJ é obrigatório.").transform(n=>n.replace(/\D/g,"")).refine(n=>n.length===11||n.length===14,{message:"CPF deve ter 11 dígitos ou CNPJ 14 dígitos."}),delivery_option:ht(["delivery","pickup"],{required_error:"Selecione uma opção de entrega."}),notes:L().optional(),payment_method_id:L().min(1,"Selecione um método de pagamento."),change_for:L().optional()}),xn=async n=>{const{data:r,error:o}=await P.from("restaurants").select("id, name, address, phone, email, street, number, neighborhood, city, zip_code, latitude, longitude, delivery_enabled").eq("id",n).eq("is_active",!0).limit(1).single();if(o)throw new Error(`Erro ao buscar restaurante: ${o.message}`);if(!r)throw new Error("Restaurante não encontrado ou inativo.");return r},gn=async n=>{const{data:r,error:o}=await P.from("delivery_zones").select("*").eq("restaurant_id",n).eq("is_active",!0).order("max_distance_km",{ascending:!0});if(o)throw new Error(`Erro ao buscar zonas de entrega: ${o.message}`);return r},yn=async n=>{const{data:r,error:o}=await P.from("payment_methods").select("*").eq("restaurant_id",n).eq("is_active",!0).order("name",{ascending:!0});if(o)throw new Error(`Erro ao buscar métodos de pagamento: ${o.message}`);return r},jn=async n=>{const{data:r,error:o}=await P.from("customers").select("*").eq("user_id",n).limit(1).single();if(o&&o.code!=="PGRST116")throw new Error(o.message);return r||null},mo=()=>{var Ye,er,rr,tr,nr;const n=ot(),r=st(),[o]=at(),u=nt(),{items:h,totalAmount:g,clearCart:_}=ut(),{data:c,isLoading:R}=pt(),[I]=l.useState((Ye=r.state)==null?void 0:Ye.restaurantId),C=o.get("restaurantId"),y=I||C,{data:D}=br(y),[E,A]=l.useState(!1),[k,G]=l.useState(!1),[ge,ce]=l.useState(0),[le,ye]=l.useState(null),[Se,te]=l.useState(!0),[Y,de]=l.useState(null),[Lr,Pe]=l.useState(!1),[Vr,zr]=l.useState(null),[Ge,qr]=l.useState(null),[U,ne]=l.useState(!1),[Gr,Be]=l.useState(!1),[Ke,Re]=l.useState(null),[Ie,Ae]=l.useState(null),{data:x,isLoading:Br,isError:Kr,error:Ue,refetch:Ur}=pe({queryKey:["checkoutRestaurantData",y],queryFn:()=>xn(y),enabled:!!y,staleTime:1/0}),{data:V,isLoading:Zr}=pe({queryKey:["checkoutDeliveryZones",y],queryFn:()=>gn(x.id),enabled:!!x,staleTime:1/0}),{data:B,isLoading:Hr}=pe({queryKey:["checkoutPaymentMethods",y],queryFn:()=>yn(x.id),enabled:!!x,staleTime:1/0}),{data:f,isLoading:Ze,refetch:vn}=pe({queryKey:["checkoutCustomerData",c==null?void 0:c.id],queryFn:()=>jn(c.id),enabled:!!c,staleTime:0}),Z=l.useMemo(()=>x!=null&&x.latitude&&(x!=null&&x.longitude)?[x.latitude,x.longitude]:null,[x]),Jr=l.useCallback(async(t,s,a,d,m,p,w)=>{const F=[30,45];if(x&&x.delivery_enabled===!1){const N=`${s}, ${a}, ${m}, ${d}, ${t}`;let b=null;if(p&&w?b={lat:p,lng:w}:b=await ar(N),!b)return{coords:null,fee:0,time:null,isValid:!1};if(V&&V.length>0&&Z){const q=Oe([b.lat,b.lng],Z,V);if(q)return{coords:b,fee:0,time:[q.minTime,q.maxTime],isValid:!0}}return{coords:b,fee:0,time:F,isValid:!0}}if(!x||!Z)return{coords:null,fee:0,time:F,isValid:!0};const M=`${s}, ${a}, ${m}, ${d}, ${t}`;let v=null;if(p&&w?v={lat:p,lng:w}:v=await ar(M),!v)return{coords:null,fee:0,time:null,isValid:!1};if(V&&V.length>0){const N=Oe([v.lat,v.lng],Z,V);return N?{coords:v,fee:N.fee,time:[N.minTime,N.maxTime],isValid:!0}:{coords:v,fee:0,time:null,isValid:!1}}else return{coords:null,fee:0,time:F,isValid:!0}},[x,Z,V]),i=ir({resolver:cr(hn),defaultValues:{name:"",phone:"",cpf_cnpj:"",delivery_option:"delivery",notes:"",payment_method_id:"",change_for:""},mode:"onBlur"}),j=ir({resolver:cr(pn),defaultValues:{zip_code:"",street:"",number:"",neighborhood:"",city:""},mode:"onBlur"}),T=i.watch("delivery_option"),Qr=i.watch("payment_method_id"),oe=B==null?void 0:B.find(t=>t.id===Qr),$e=(er=oe==null?void 0:oe.name)==null?void 0:er.includes("online"),ue=(rr=oe==null?void 0:oe.name)==null?void 0:rr.includes("Dinheiro"),z=g+ge,$=j.watch(["zip_code","street","number","city","neighborhood"]),He=l.useMemo(()=>{const[t,s,a,d,m]=$;return`${s}|${a}|${m}|${d}|${t}`},[$]);l.useEffect(()=>{if(ne(!1),de(null),ce(0),ye(null),te(!0),Ae(null),j.reset({zip_code:"",street:"",number:"",neighborhood:"",city:""}),f){if(i.reset({...i.getValues(),name:f.name||"",phone:xr(f.phone||""),cpf_cnpj:gr(f.cpf_cnpj||""),change_for:""}),f.latitude&&f.longitude&&f.street&&f.number&&f.zip_code){const t=f.zip_code||"",s=f.street||"",a=f.number||"",d=f.neighborhood||"",m=f.city||"";j.reset({zip_code:t,street:s,number:a,neighborhood:d,city:m});const p=`${s}|${a}|${d}|${m}|${t}`;if(Ae(p),Z&&V){const w=Oe([f.latitude,f.longitude],Z,V);w?(ce(w.fee),ye([w.minTime,w.maxTime]),te(!0),ne(!0),de([f.latitude,f.longitude])):(ce(0),te(!1),ne(!0),de([f.latitude,f.longitude]))}}}else if(c&&!Ze){const t=c.user_metadata;i.reset({...i.getValues(),name:t.full_name||"",phone:xr(t.phone||""),cpf_cnpj:gr(t.cpf_cnpj||""),change_for:""})}},[f,i,c,Ze,j,Z,V]),l.useEffect(()=>{T==="delivery"&&Ie!==null&&He!==Ie&&(ne(!1),ce(0),ye(null),te(!0),de(null))},[He,Ie,T]);const je=i.watch("change_for");l.useEffect(()=>{if(ue&&je&&je.trim()!==""){const t=je.replace(",","."),s=parseFloat(t);isNaN(s)?i.setError("change_for",{message:"O troco deve ser um número válido."}):s<z?i.setError("change_for",{message:`O troco deve ser maior ou igual ao total do pedido (${new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(z)}).`}):i.clearErrors("change_for")}else i.clearErrors("change_for")},[ue,je,z,i]);const ve=Fe({mutationFn:async t=>{var or;console.log("=== INICIANDO SALVAMENTO DE ENDEREÇO ==="),console.log("Dados do endereço:",t),G(!0);const s=`${t.street}, ${t.number}, ${t.neighborhood}, ${t.city}, ${t.zip_code}`;console.log("Endereço completo:",s),console.log("Iniciando geocodificação...");const a=await Jr(t.zip_code,t.street,t.number,t.city,t.neighborhood);if(G(!1),console.log("Resultado da geocodificação:",a),!a.isValid)throw console.error("Endereço inválido ou fora da área de entrega"),new Error((x==null?void 0:x.delivery_enabled)===!1?"O endereço está errado ou incompleto, revise todos os campos.":"Endereço fora da área de entrega.");if(!a.coords)throw new Error("Não foi possível obter as coordenadas para salvar o endereço.");const m=(or=(await P.auth.getUser()).data.user)==null?void 0:or.id,p=i.getValues("name"),w=i.getValues("phone"),F=i.getValues("cpf_cnpj"),M=w.replace(/\D/g,""),v=F.replace(/\D/g,"");if(console.log("=== VALIDAÇÃO DE CONTATO ==="),console.log("Nome:",p),console.log("Telefone limpo:",M,"Comprimento:",M.length),console.log("CPF/CNPJ limpo:",v,"Comprimento:",v.length),!p||M.length<10||!v||v.length!==11&&v.length!==14){const ee="Preencha Nome, Telefone (10+ dígitos) e CPF/CNPJ (11 ou 14 dígitos) nos Seus Dados antes de salvar o endereço.";throw console.error("ERRO DE VALIDAÇÃO:",ee),new Error(ee)}if(console.log("Validação de contato passou!"),!(f!=null&&f.id)&&!m)return{customer:{id:"anonymous",user_id:null,name:p,phone:M,email:null,address:s,created_at:"",updated_at:"",latitude:a.coords.lat,longitude:a.coords.lng,cpf_cnpj:v,street:t.street,number:t.number,neighborhood:t.neighborhood,city:t.city,zip_code:t.zip_code},feeResult:a};const N={name:p,phone:M,cpf_cnpj:v||null},b={user_id:(c==null?void 0:c.id)||null,...N,email:(c==null?void 0:c.email)||null,address:s,latitude:a.coords.lat,longitude:a.coords.lng,street:t.street,number:t.number,neighborhood:t.neighborhood,city:t.city,zip_code:t.zip_code},q="*, street, number, neighborhood, city, zip_code";let De;if(f!=null&&f.id){const{data:ee,error:me}=await P.from("customers").update(b).eq("id",f.id).select(q).single();if(me)throw me;De=ee}else if(m){const{data:ee,error:me}=await P.from("customers").insert(b).select(q).single();if(me)throw me;De=ee}else throw new Error("Não foi possível identificar o cliente para salvar.");return{customer:De,feeResult:a}},onSuccess:(t,s)=>{const{customer:a,feeResult:d}=t;(a==null?void 0:a.id)!=="anonymous"&&u.invalidateQueries({queryKey:["checkoutCustomerData"]}),ce(d.fee),ye(d.time),te(d.isValid),ne(!0),de([d.coords.lat,d.coords.lng]);const m=`${s.street}|${s.number}|${s.neighborhood}|${s.city}|${s.zip_code}`;Ae(m),S.success("Endereço salvo e taxa de entrega calculada!")},onError:t=>{S.error(`Erro ao salvar endereço: ${t.message}`),te(!1),ne(!1)}}),Xr=t=>{console.log("=== handleSaveAddress CHAMADO ==="),console.log("Dados recebidos:",t),i.trigger(["name","phone","cpf_cnpj"]).then(s=>{console.log("Validação de contato (form.trigger):",s),s?ve.mutate(t):S.error("Preencha Nome, Telefone e CPF/CNPJ nos Seus Dados antes de salvar o endereço.")})},Je=Fe({mutationFn:async t=>{var F,M;(F=(await P.auth.getUser()).data.user)==null||F.id;const a=t.phone.replace(/\D/g,""),d=((M=t.cpf_cnpj)==null?void 0:M.replace(/\D/g,""))||null;if(!t.name||a.length<10||d&&d.length!==11&&d.length!==14)throw new Error("Dados de contato incompletos ou inválidos.");const m=T==="delivery"?`${$[1]}, ${$[2]}, ${$[4]}, ${$[3]}, ${$[0]}`:null,p={user_id:(c==null?void 0:c.id)||null,name:t.name,phone:a,email:(c==null?void 0:c.email)||null,cpf_cnpj:d,address:m,latitude:Y?Y[0]:null,longitude:Y?Y[1]:null,street:j.getValues("street")||null,number:j.getValues("number")||null,neighborhood:j.getValues("neighborhood")||null,city:j.getValues("city")||null,zip_code:j.getValues("zip_code")||null};c||(p.email=null);const w="*, street, number, neighborhood, city, zip_code";if(c)if(f){const{data:v,error:N}=await P.from("customers").update(p).eq("id",f.id).select(w).single();if(N)throw N;return v}else{const{data:v,error:N}=await P.from("customers").insert(p).select(w).single();if(N)throw N;return v}else{const{data:v,error:N}=await P.from("customers").insert(p).select(w).single();if(N)throw N;return v}},onSuccess:()=>{u.invalidateQueries({queryKey:["checkoutCustomerData"]})},onError:t=>{S.error(`Erro ao salvar dados do cliente: ${t.message}`)}}),Qe=Fe({mutationFn:async({customerId:t,data:s})=>{if(!x)throw new Error("Dados do restaurante não disponíveis.");let a=null;if(ue&&s.change_for&&s.change_for.trim()!==""){const b=s.change_for.replace(",","."),q=parseFloat(b);!isNaN(q)&&q>z&&(a=q)}let[d,m]=le||[null,null];if((T==="delivery"||T==="pickup")&&(!d||!m)){const b=T==="pickup"?[15,30]:[30,45];d=b[0],m=b[1]}const p=T==="delivery"?`${$[1]}, ${$[2]}, ${$[4]}, ${$[3]}, ${$[0]}`:null,w={restaurant_id:x.id,customer_id:t,status:$e?"pending_payment":"pending",total_amount:z,delivery_fee:ge,delivery_address:p,notes:s.notes,payment_method_id:s.payment_method_id,change_for:a,min_delivery_time_minutes:d,max_delivery_time_minutes:m},{data:F,error:M}=await P.from("orders").insert(w).select("id").single();if(M)throw M;const v=h.map(b=>({order_id:F.id,product_id:b.product.id,quantity:parseFloat(b.quantity.toFixed(3)),unit_price:parseFloat(b.product.price.toFixed(2)),subtotal:parseFloat(b.subtotal.toFixed(2)),notes:b.notes})),{error:N}=await P.from("order_items").insert(v);if(N)throw N;return F.id},onSuccess:t=>{u.invalidateQueries({queryKey:["orders"]})},onError:t=>{S.error(`Erro ao criar pedido: ${t.message}`)}}),Wr=async t=>{if(ue&&t.change_for&&t.change_for.trim()!==""){const d=t.change_for.replace(",","."),m=parseFloat(d);if(isNaN(m)){S.error("O troco deve ser um número válido.");return}if(m<z){i.setError("change_for",{type:"manual",message:`O troco deve ser maior ou igual ao total do pedido (${new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(z)}).`});return}}if(h.length===0){S.error("Seu carrinho está vazio."),n(`/menu/${y}`);return}if(T==="delivery"){if(!U){S.error("Você deve salvar e validar o endereço de entrega antes de finalizar o pedido.");return}if(!Se){S.error("O endereço de entrega está fora da área de cobertura.");return}}let s;try{s=(await Je.mutateAsync(t)).id}catch(d){S.error(`Falha ao salvar cliente: ${d.message}`);return}let a;try{a=await Qe.mutateAsync({customerId:s,data:t})}catch(d){S.error(`Falha ao criar pedido: ${d.message}`);return}$e?await Yr(a,t):(_(),n(`/order-success/${a}`,{replace:!0}))},Yr=async(t,s)=>{if(!x)return;const a=window.location.origin+window.location.pathname,d=h.map(p=>({name:p.product.name,price:p.product.price,quantity:p.quantity})),m=S.loading("Preparando pagamento online...");try{const{data:p,error:w}=await P.functions.invoke("create-payment-preference",{body:{orderId:t,items:d,totalAmount:z,restaurantName:x.name,clientUrl:a,customerEmail:(c==null?void 0:c.email)||"cliente@anonimo.com",customerCpfCnpj:s.cpf_cnpj}});if(w)throw w;const{init_point:F}=p;zr(t),qr(F),Pe(!0),S.dismiss(m)}catch(p){S.dismiss(m),S.error(`Erro no pagamento online: ${p.message}`),Pe(!1)}},et=async()=>{await P.auth.signOut(),S.success("Você saiu da sua conta."),n("/auth",{replace:!0})},rt=(t,s,a)=>{s&&a?(Re(t),Be(!0)):(i.setValue("payment_method_id",t,{shouldValidate:!0}),Re(null))},tt=()=>{Ke&&i.setValue("payment_method_id",Ke,{shouldValidate:!0}),Be(!1),Re(null)},Xe=l.useMemo(()=>{const[t,s,a,d,m]=$;return s&&a&&m&&d&&t?`${s}, ${a} - ${m}, ${d}, ${t}`:""},[$]);if(!y)return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(re,{variant:"destructive",className:"max-w-lg",children:[e.jsx(fr,{className:"h-4 w-4"}),e.jsx(ae,{children:"Erro de Rastreamento"}),e.jsx(ie,{children:"Não foi possível identificar o restaurante para o qual o pedido está sendo feito. Por favor, volte ao menu."}),e.jsx(Me,{to:"/",children:e.jsx(H,{className:"mt-3",variant:"secondary",size:"sm",children:"Voltar"})})]})});if(h.length===0)return l.useEffect(()=>{n(`/menu/${y}`)},[n,y]),e.jsx(sr,{});if(Br||Zr||Hr||R)return e.jsx(sr,{});if(Kr||!x)return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(re,{variant:"destructive",className:"max-w-lg",children:[e.jsx(fr,{className:"h-4 w-4"}),e.jsx(ae,{children:"Erro Crítico"}),e.jsx(ie,{children:Ue instanceof Error?Ue.message:"Não foi possível carregar os dados do restaurante."}),e.jsxs(H,{onClick:()=>Ur(),className:"mt-3",variant:"secondary",size:"sm",children:[e.jsx(Tt,{className:"h-4 w-4 mr-2"})," Tentar Novamente"]})]})});const We=Je.isPending||Qe.isPending||ve.isPending||k||T==="delivery"&&!U;return e.jsxs("div",{className:"min-h-screen bg-background py-4 sm:py-8 px-4 sm:px-8",children:[e.jsx(_t,{isOpen:E,onClose:()=>A(!1),customer:f}),e.jsx(fn,{isOpen:Gr,onConfirm:tt}),Lr&&Ge&&e.jsx(un,{preferenceId:Vr,initPoint:Ge,onClose:()=>Pe(!1)}),e.jsxs("div",{className:"w-full lg:max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Me,{to:`/menu/${y}`,children:e.jsx(H,{variant:"ghost",size:"icon","aria-label":"Voltar ao Menu",children:e.jsx(Lt,{className:"h-6 w-6"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Finalizar Pedido"}),e.jsx("p",{className:"text-lg text-muted-foreground font-medium",children:x.name})]})]}),c&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>A(!0),"aria-label":"Meu Perfil e Pedidos",children:[e.jsx(pr,{className:"h-4 w-4 mr-2"})," Perfil / Pedidos"]}),e.jsxs(H,{variant:"outline",size:"sm",onClick:et,children:[e.jsx(Nt,{className:"h-4 w-4 mr-1"})," Sair"]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(X,{className:"text-xl flex items-center gap-2",children:[e.jsx(pr,{className:"h-5 w-5 text-primary"})," Seus Dados"]})}),e.jsxs(W,{children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:c?`Logado como ${c.email}. ${f?"Perfil de cliente encontrado.":"Preencha os dados para criar seu perfil de cliente."}`:"Você está fazendo um pedido anônimo."})}),e.jsx(mr,{...i,children:e.jsx("form",{onSubmit:i.handleSubmit(Wr),id:"checkout-form",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"name",children:"Nome Completo *"}),e.jsx(se,{id:"name",...i.register("name")}),i.formState.errors.name&&e.jsx("p",{className:"text-destructive text-sm",children:i.formState.errors.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"phone",children:"Telefone *"}),e.jsx(fe,{name:"phone",control:i.control,render:({field:t})=>e.jsx(wt,{id:"phone",...t})}),i.formState.errors.phone&&e.jsx("p",{className:"text-destructive text-sm",children:i.formState.errors.phone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"cpf_cnpj",children:"CPF/CNPJ *"}),e.jsx(fe,{name:"cpf_cnpj",control:i.control,render:({field:t})=>e.jsx(Pt,{id:"cpf_cnpj",...t})}),i.formState.errors.cpf_cnpj&&e.jsx("p",{className:"text-destructive text-sm",children:i.formState.errors.cpf_cnpj.message})]})]})})})]})]}),e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(X,{className:"text-xl flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5 text-primary"})," Opção de Entrega"]})}),e.jsx(W,{children:e.jsx(fe,{name:"delivery_option",control:i.control,render:({field:t})=>e.jsxs(Le,{onValueChange:t.onChange,value:t.value,className:"grid grid-cols-2 gap-4",children:[e.jsxs(O,{htmlFor:"delivery",className:"flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-primary cursor-pointer",children:[e.jsx(Ne,{value:"delivery",id:"delivery",className:"sr-only"}),e.jsx(we,{className:"mb-3 h-6 w-6"}),e.jsx("span",{translate:"no",children:"Entrega"})]}),e.jsxs(O,{htmlFor:"pickup",className:"flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-primary cursor-pointer",children:[e.jsx(Ne,{value:"pickup",id:"pickup",className:"sr-only"}),e.jsx(Te,{className:"mb-3 h-6 w-6"}),e.jsx("span",{translate:"no",children:"Retirada no Local"})]})]})})})]}),T==="delivery"&&e.jsxs(J,{className:xe(!U&&"border-destructive ring-2 ring-destructive/50"),children:[e.jsxs(Q,{children:[e.jsxs(X,{className:"text-xl flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-primary"})," Endereço de Entrega",U&&e.jsx(Vt,{className:"h-5 w-5 text-green-500 ml-2"}),!U&&e.jsx(_e,{className:"h-5 w-5 text-destructive ml-2"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Preencha e salve o endereço para calcular a taxa de entrega."})]}),e.jsxs(W,{className:"space-y-4",children:[x.delivery_enabled===!1&&e.jsxs(re,{variant:"default",className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 text-blue-700",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx(ae,{children:"Frete Grátis Ativo"}),e.jsx(ie,{children:"As taxas de entrega dinâmica estão desativadas. O frete será R$ 0,00."})]}),e.jsx(mr,{...j,children:e.jsxs("form",{onSubmit:j.handleSubmit(Xr),id:"address-form-inner",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2 md:col-span-1",children:[e.jsx(O,{htmlFor:"zip_code",children:"CEP *"}),e.jsx(fe,{name:"zip_code",control:j.control,render:({field:t})=>e.jsx(Ot,{className:"flex-1 space-y-0",children:e.jsx(kt,{children:e.jsx(ft,{placeholder:"Digite o CEP",...t})})})}),j.formState.errors.zip_code&&e.jsx("p",{className:"text-destructive text-sm",children:j.formState.errors.zip_code.message})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(O,{htmlFor:"street",children:"Rua *"}),e.jsx(se,{id:"street",...j.register("street")}),j.formState.errors.street&&e.jsx("p",{className:"text-destructive text-sm",children:j.formState.errors.street.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"number",children:"Número *"}),e.jsx(se,{id:"number",...j.register("number")}),j.formState.errors.number&&e.jsx("p",{className:"text-destructive text-sm",children:j.formState.errors.number.message})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(O,{htmlFor:"neighborhood",children:"Bairro *"}),e.jsx(se,{id:"neighborhood",...j.register("neighborhood")}),j.formState.errors.neighborhood&&e.jsx("p",{className:"text-destructive text-sm",children:j.formState.errors.neighborhood.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"city",children:"Cidade *"}),e.jsx(se,{id:"city",...j.register("city")}),j.formState.errors.city&&e.jsx("p",{className:"text-destructive text-sm",children:j.formState.errors.city.message})]}),e.jsxs(H,{type:"submit",className:"w-full h-10 text-base mt-4",disabled:ve.isPending||k,children:[ve.isPending||k?e.jsx(he,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(zt,{className:"h-4 w-4 mr-2"}),"Salvar Endereço e Calcular Taxa"]})]})}),k&&e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 animate-spin"}),e.jsx(ae,{children:"Calculando Taxa de Entrega..."})]}),U&&!k&&e.jsxs(e.Fragment,{children:[x.delivery_enabled!==!1&&!Se&&e.jsxs(re,{variant:"destructive",children:[e.jsx(_e,{className:"h-4 w-4"}),e.jsx(ae,{children:"Fora da Área de Entrega"}),e.jsx(ie,{children:"Seu endereço está fora da área de cobertura do restaurante."})]}),(x.delivery_enabled===!1||Se&&le)&&e.jsxs(re,{variant:"default",className:"bg-green-50 dark:bg-green-900/20 border-green-200 text-green-700",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx(ae,{children:"Entrega Disponível"}),e.jsxs(ie,{children:["Taxa de entrega: ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(ge),". Tempo estimado: ",le?`${le[0]} - ${le[1]}`:"30 - 45"," minutos."]})]})]}),U&&Y&&Xe&&e.jsx("div",{className:"mt-6",children:e.jsx(mn,{latitude:Y[0],longitude:Y[1],address:Xe})})]})]}),e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(X,{className:"text-xl flex items-center gap-2",children:[e.jsx(wr,{className:"h-5 w-5 text-primary"})," Método de Pagamento *"]})}),e.jsxs(W,{children:[e.jsx(fe,{name:"payment_method_id",control:i.control,render:({field:t})=>e.jsx(Le,{onValueChange:s=>{var p;const a=B==null?void 0:B.find(w=>w.id===s),d=(p=a==null?void 0:a.name)==null?void 0:p.includes("online"),m=!!D&&D.trim()!=="";rt(s,!!d,m)},value:t.value,className:"space-y-3",children:B==null?void 0:B.map(s=>{var p;const a=(p=s.name)==null?void 0:p.includes("online"),d=!!D&&D.trim()!=="",m=a&&!d;return e.jsx(O,{htmlFor:s.id,className:xe("flex items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground [&:has([data-state=checked])]:border-primary cursor-pointer",m&&"opacity-50 cursor-not-allowed"),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ne,{value:s.id,id:s.id,disabled:m}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",translate:"no",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),m&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:"Pagamento online indisponível no momento."})]})]})},s.id)})})}),i.formState.errors.payment_method_id&&e.jsx("p",{className:"text-destructive text-sm mt-2",children:i.formState.errors.payment_method_id.message})]})]}),ue&&e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(X,{className:"text-xl flex items-center gap-2",children:[e.jsx(qt,{className:"h-5 w-5 text-primary"})," Troco"]})}),e.jsx(W,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"change_for",children:"Precisa de troco para quanto? (Opcional)"}),e.jsx(se,{id:"change_for",type:"number",step:"0.01",placeholder:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(z),...i.register("change_for")}),((tr=i.formState.errors.change_for)==null?void 0:tr.message)&&e.jsx("p",{className:"text-destructive text-sm",children:i.formState.errors.change_for.message}),((nr=i.formState.errors.change_for)==null?void 0:nr.type)==="manual"&&e.jsx("p",{className:"text-destructive text-sm",children:i.formState.errors.change_for.message})]})})]}),e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(X,{className:"text-xl flex items-center gap-2",children:[e.jsx(bt,{className:"h-5 w-5 text-primary"})," Observações"]})}),e.jsx(W,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"notes",children:"Notas para o restaurante (Opcional)"}),e.jsx(xt,{id:"notes",...i.register("notes"),rows:3,placeholder:"Ex: Entregar na portaria, sem pimenta, etc."})]})})]})]}),e.jsx("div",{className:"lg:col-span-1 space-y-6 sticky top-4 self-start",children:e.jsxs(J,{className:"shadow-lg",children:[e.jsx(Q,{children:e.jsx(X,{className:"text-2xl",children:"Resumo"})}),e.jsxs(W,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:h.map(t=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"truncate max-w-[70%]",children:[t.quantity,"x ",t.product.name]}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t.subtotal)})]},t.product.id))}),e.jsx(lr,{}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g)})]}),e.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:"Taxa de Entrega"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(ge)})]})]}),e.jsx(lr,{}),e.jsxs("div",{className:"flex justify-between font-bold text-xl",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(z)})]}),e.jsx(H,{type:"submit",form:"checkout-form",className:"w-full h-12 text-lg",disabled:We,children:We?e.jsx(he,{className:"h-5 w-5 animate-spin mr-2"}):$e?"Pagar e Finalizar":"Confirmar Pedido"}),T==="delivery"&&!U&&e.jsxs(re,{variant:"destructive",className:"mt-3",children:[e.jsx(_e,{className:"h-4 w-4"}),e.jsx(ie,{className:"text-xs",children:"Salve o endereço acima para continuar."})]}),e.jsx(Me,{to:`/menu/${x.id}`,className:"block text-center text-sm text-muted-foreground hover:underline mt-2",children:"Voltar ao Cardápio"})]})]})})]})]})]})};export{mo as default};
