import{j as e,a as Ie}from"./tanstack-E1juXnZE.js";import{r as c,R as ne,L as ae}from"./vendor-nYMJN4lg.js";import{s as I}from"./client-DHSUo4L7.js";import{c as B,a as _,b as W,e as Fe,f as A,P as k,o as Y,h as C,m as N,q as He,d as Be}from"./index-2W2_6B9d.js";import{A as le,a as ie,b as ce}from"./alert-XH9PkOo9.js";import{M as We}from"./map-pin-BYzD9Xve.js";import{C as Xe}from"./circle-check-big-D8cH-o_R.js";import{C as Ye}from"./circle-x-Dt2tIjfj.js";import{C as de}from"./clock-BNXrnSSK.js";import{C as me,d as qe}from"./card-CDdiaJK6.js";import{B as g}from"./button-DeWcX41H.js";import{d as he,e as ue,f as fe,g as xe,h as pe,i as be,X as $e}from"./dialog-C97hO83p.js";import{I as Z}from"./input-Cn4mXPNo.js";import{T as ge}from"./textarea-Bjj-161u.js";import{D as we}from"./dollar-sign-DDhv2Ycd.js";import{P as q}from"./plus-f4WniFre.js";import{S as E}from"./shopping-cart-CGvcQ1Dy.js";import{S as Ve,b as Ue,u as Qe}from"./use-mobile-DvxLiPbw.js";import{u as Ze,c as Ke}from"./index-DNYFYjXG.js";import{T as Ge}from"./terminal-BJCNtcCC.js";import"./supabase-CBMN163Q.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=B("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=B("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=B("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=B("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),Je=()=>{const r=new Date,o=String(r.getHours()).padStart(2,"0"),t=String(r.getMinutes()).padStart(2,"0");return`${o}:${t}`},er=()=>new Date().getDay(),ye=r=>{const o=er(),t=Je(),n=r.find(d=>d.day_of_week===o);if(!n||!n.is_open)return{isOpen:!1,todayHours:"Fechado hoje"};const s=n.open_time,a=n.close_time;if(!s||!a)return{isOpen:!1,todayHours:"Horário não configurado"};const l=t>=s&&t<=a,i=`${s.substring(0,5)} - ${a.substring(0,5)}`;return{isOpen:l,todayHours:i}},rr=({restaurant:r,hours:o})=>{const{isOpen:t,todayHours:n}=ye(o),s=[r.street,r.number,r.neighborhood,r.city,r.zip_code].filter(Boolean).join(", ");return e.jsxs("div",{className:"space-y-3 text-center",children:[s&&e.jsxs("div",{className:"flex items-center justify-center text-sm text-muted-foreground",children:[e.jsx(We,{className:"h-4 w-4 mr-1 flex-shrink-0"}),e.jsx("span",{className:"truncate max-w-full",children:s})]}),e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:[e.jsxs("div",{className:_("flex items-center gap-1 px-3 py-1 rounded-full",t?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"),children:[t?e.jsx(Xe,{className:"h-4 w-4"}):e.jsx(Ye,{className:"h-4 w-4"}),e.jsx("span",{children:t?"Aberto Agora":"Fechado"})]}),e.jsxs("div",{className:"ml-4 flex items-center text-muted-foreground",children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:n})]})]})]})},tr=({todayHours:r})=>e.jsxs(le,{variant:"destructive",className:"mb-6",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx(ie,{children:"Loja Fechada"}),e.jsxs(ce,{children:["A loja está fechada no momento. Nosso horário de funcionamento hoje é das ",r,". Você pode fazer o pedido, mas ele só será processado quando reabrirmos."]})]}),sr=({src:r,alt:o,className:t,...n})=>{const[s,a]=c.useState(!0),[l,i]=c.useState(!1),[d,m]=c.useState(r);c.useEffect(()=>{a(!0),i(!1),m(r)},[r]);const h=()=>{a(!1)},f=()=>{a(!1),i(!0),m("/placeholder.svg")};return e.jsxs("div",{className:_("relative overflow-hidden",t),children:[s&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted animate-pulse",children:e.jsx(te,{className:"h-8 w-8 text-muted-foreground"})}),l&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted",children:e.jsx(te,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("img",{src:d,alt:o,onLoad:h,onError:f,className:_("w-full h-full object-cover transition-opacity duration-500",s?"opacity-0":"opacity-100"),...n})]})},or=({isOpen:r,onClose:o,product:t,onAddToCart:n})=>{const[s,a]=c.useState(t.is_price_by_weight?.5:1),[l,i]=c.useState("");ne.useEffect(()=>{r&&(a(t.is_price_by_weight?.5:1),i(""))},[r,t.is_price_by_weight]);const d=u=>{a(x=>{const p=t.is_price_by_weight?.1:1,y=Math.max(p,x+u);return t.is_price_by_weight?parseFloat(y.toFixed(1)):Math.round(y)})},m=()=>{s<=0||(n(s,l),o())},h=t.price*s,f=u=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(u);return e.jsx(he,{open:r,onOpenChange:o,children:e.jsxs(ue,{className:"sm:max-w-[425px] p-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.image_url||"/placeholder.svg",alt:t.name,className:"w-full h-48 object-cover"}),e.jsx(g,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 bg-background/80 hover:bg-background",onClick:o,children:e.jsx(X,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs(fe,{className:"p-0",children:[e.jsx(xe,{className:"text-2xl font-bold",children:t.name}),e.jsx(pe,{className:"text-sm",children:t.description||"Sem descrição disponível."})]}),e.jsxs("div",{className:"flex items-center justify-between border-y py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{className:"text-lg font-semibold",children:[f(t.price),t.is_price_by_weight&&e.jsx("span",{className:"text-sm font-normal text-muted-foreground",children:" / kg"})]})]}),e.jsxs("div",{className:"flex items-center border rounded-md h-10",children:[e.jsx(g,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>d(t.is_price_by_weight?-.1:-1),disabled:s<=(t.is_price_by_weight?.1:1),children:e.jsx(K,{className:"h-5 w-5"})}),e.jsx(Z,{type:t.is_price_by_weight?"number":"text",step:t.is_price_by_weight?"0.1":"1",value:t.is_price_by_weight?s.toFixed(1):s,onChange:u=>{const x=parseFloat(u.target.value);x>0&&a(x)},className:"w-16 h-10 text-center border-y-0 rounded-none p-0 focus-visible:ring-0",readOnly:!t.is_price_by_weight}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>d(t.is_price_by_weight?.1:1),children:e.jsx(q,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"notes",className:"text-sm font-medium",children:"Observações (Opcional)"}),e.jsx(ge,{id:"notes",placeholder:"Ex: Sem cebola, molho extra...",value:l,onChange:u=>i(u.target.value),rows:2})]}),e.jsx(be,{className:"pt-4",children:e.jsxs(g,{type:"button",className:"w-full h-12 text-lg flex items-center justify-between px-6",onClick:m,disabled:s<=0,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Adicionar"]}),e.jsx("span",{className:"font-bold",children:f(h)})]})})]})]})})},nr=({isOpen:r,onClose:o,product:t,onAddToCart:n})=>{const[s,a]=c.useState(.5),[l,i]=c.useState("");ne.useEffect(()=>{r&&(a(.5),i(""))},[r]);const d=u=>{a(x=>{const p=Math.max(.1,x+u);return parseFloat(p.toFixed(1))})},m=()=>{s<=0||(n(s,l),o())},h=t.price*s,f=u=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(u);return e.jsx(he,{open:r,onOpenChange:o,children:e.jsxs(ue,{className:"sm:max-w-[425px]",children:[e.jsxs(fe,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5 text-primary"}),t.name," (Por Peso)"]}),e.jsxs(pe,{children:["Informe a quantidade em quilogramas (kg). Preço: ",f(t.price),"/kg."]})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between border-y py-3",children:[e.jsx("label",{className:"text-lg font-semibold",children:"Quantidade (kg)"}),e.jsxs("div",{className:"flex items-center border rounded-md h-10",children:[e.jsx(g,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>d(-.1),disabled:s<=.1,children:e.jsx(K,{className:"h-5 w-5"})}),e.jsx(Z,{type:"number",step:"0.1",value:s.toFixed(1),onChange:u=>{const x=parseFloat(u.target.value);x>0&&a(parseFloat(x.toFixed(1)))},className:"w-16 h-10 text-center border-y-0 rounded-none p-0 focus-visible:ring-0"}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-10 w-10",onClick:()=>d(.1),children:e.jsx(q,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"notes",className:"text-sm font-medium",children:"Observações (Opcional)"}),e.jsx(ge,{id:"notes",placeholder:"Ex: Quero 1.2kg, por favor.",value:l,onChange:u=>i(u.target.value),rows:2})]})]}),e.jsx(be,{className:"pt-4",children:e.jsxs(g,{type:"button",className:"w-full h-12 text-lg flex items-center justify-between px-6",onClick:m,disabled:s<=0,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Adicionar ao Carrinho"]}),e.jsx("span",{className:"font-bold",children:f(h)})]})})]})})},ar=({product:r})=>{const{addItem:o}=W(),[t,n]=c.useState(!1),[s,a]=c.useState(!1),l=(m=1,h="")=>{o(r,m,h)},i=()=>{r.is_price_by_weight?a(!0):l(1,"")},d=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m);return e.jsxs(e.Fragment,{children:[e.jsx(or,{isOpen:t,onClose:()=>n(!1),product:r,onAddToCart:l}),e.jsx(nr,{isOpen:s,onClose:()=>a(!1),product:r,onAddToCart:l}),e.jsxs(me,{className:"overflow-hidden shadow-md hover:shadow-lg transition-shadow duration-300 flex flex-col",children:[e.jsxs("div",{className:"relative cursor-pointer",onClick:()=>n(!0),children:[e.jsx(sr,{src:r.image_url||"/placeholder.svg",alt:r.name,className:"w-full h-48 object-cover"}),r.is_price_by_weight&&e.jsxs("div",{className:"absolute top-2 left-2 bg-primary text-primary-foreground text-xs font-bold px-2 py-1 rounded-full flex items-center gap-1",children:[e.jsx(je,{className:"h-3 w-3"})," Preço por Peso"]})]}),e.jsxs(qe,{className:"p-4 flex-grow flex flex-col justify-between",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-lg font-semibold mb-1 truncate",children:r.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:r.description})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t",children:[e.jsxs("p",{className:"text-xl font-bold text-primary flex items-center gap-1",children:[e.jsx(we,{className:"h-5 w-5"}),d(r.price),r.is_price_by_weight&&e.jsx("span",{className:"text-sm font-normal text-muted-foreground",children:"/kg"})]}),e.jsx(g,{size:"icon",onClick:i,children:e.jsx(q,{className:"h-5 w-5"})})]})]})]})]})},lr=({totalItems:r,onClick:o})=>e.jsxs(g,{onClick:o,className:_("fixed bottom-4 right-4 z-40 rounded-full h-14 w-14 shadow-xl transition-transform duration-300",r>0?"scale-100":"scale-0 pointer-events-none"),"aria-label":`Ver carrinho com ${r} itens`,children:[e.jsx(E,{className:"h-6 w-6"}),r>0&&e.jsx("span",{className:"absolute top-0 right-0 transform translate-x-1/4 -translate-y-1/4 bg-destructive text-destructive-foreground text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:r})]});function ir(r,o){return c.useReducer((t,n)=>o[t][n]??t,r)}var G="ScrollArea",[Se,$r]=Fe(G),[cr,w]=Se(G),Ne=c.forwardRef((r,o)=>{const{__scopeScrollArea:t,type:n="hover",dir:s,scrollHideDelay:a=600,...l}=r,[i,d]=c.useState(null),[m,h]=c.useState(null),[f,u]=c.useState(null),[x,p]=c.useState(null),[y,U]=c.useState(null),[S,L]=c.useState(0),[Q,D]=c.useState(0),[M,T]=c.useState(!1),[O,z]=c.useState(!1),b=A(o,P=>d(P)),v=Ze(s);return e.jsx(cr,{scope:t,type:n,dir:v,scrollHideDelay:a,scrollArea:i,viewport:m,onViewportChange:h,content:f,onContentChange:u,scrollbarX:x,onScrollbarXChange:p,scrollbarXEnabled:M,onScrollbarXEnabledChange:T,scrollbarY:y,onScrollbarYChange:U,scrollbarYEnabled:O,onScrollbarYEnabledChange:z,onCornerWidthChange:L,onCornerHeightChange:D,children:e.jsx(k.div,{dir:v,...l,ref:b,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":Q+"px",...r.style}})})});Ne.displayName=G;var Ce="ScrollAreaViewport",_e=c.forwardRef((r,o)=>{const{__scopeScrollArea:t,children:n,nonce:s,...a}=r,l=w(Ce,t),i=c.useRef(null),d=A(o,i,l.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),e.jsx(k.div,{"data-radix-scroll-area-viewport":"",...a,ref:d,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...r.style},children:e.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});_e.displayName=Ce;var j="ScrollAreaScrollbar",J=c.forwardRef((r,o)=>{const{forceMount:t,...n}=r,s=w(j,r.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:l}=s,i=r.orientation==="horizontal";return c.useEffect(()=>(i?a(!0):l(!0),()=>{i?a(!1):l(!1)}),[i,a,l]),s.type==="hover"?e.jsx(dr,{...n,ref:o,forceMount:t}):s.type==="scroll"?e.jsx(mr,{...n,ref:o,forceMount:t}):s.type==="auto"?e.jsx(Pe,{...n,ref:o,forceMount:t}):s.type==="always"?e.jsx(ee,{...n,ref:o}):null});J.displayName=j;var dr=c.forwardRef((r,o)=>{const{forceMount:t,...n}=r,s=w(j,r.__scopeScrollArea),[a,l]=c.useState(!1);return c.useEffect(()=>{const i=s.scrollArea;let d=0;if(i){const m=()=>{window.clearTimeout(d),l(!0)},h=()=>{d=window.setTimeout(()=>l(!1),s.scrollHideDelay)};return i.addEventListener("pointerenter",m),i.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),i.removeEventListener("pointerenter",m),i.removeEventListener("pointerleave",h)}}},[s.scrollArea,s.scrollHideDelay]),e.jsx(Y,{present:t||a,children:e.jsx(Pe,{"data-state":a?"visible":"hidden",...n,ref:o})})}),mr=c.forwardRef((r,o)=>{const{forceMount:t,...n}=r,s=w(j,r.__scopeScrollArea),a=r.orientation==="horizontal",l=V(()=>d("SCROLL_END"),100),[i,d]=ir("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return c.useEffect(()=>{if(i==="idle"){const m=window.setTimeout(()=>d("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(m)}},[i,s.scrollHideDelay,d]),c.useEffect(()=>{const m=s.viewport,h=a?"scrollLeft":"scrollTop";if(m){let f=m[h];const u=()=>{const x=m[h];f!==x&&(d("SCROLL"),l()),f=x};return m.addEventListener("scroll",u),()=>m.removeEventListener("scroll",u)}},[s.viewport,a,d,l]),e.jsx(Y,{present:t||i!=="hidden",children:e.jsx(ee,{"data-state":i==="hidden"?"hidden":"visible",...n,ref:o,onPointerEnter:C(r.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:C(r.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),Pe=c.forwardRef((r,o)=>{const t=w(j,r.__scopeScrollArea),{forceMount:n,...s}=r,[a,l]=c.useState(!1),i=r.orientation==="horizontal",d=V(()=>{if(t.viewport){const m=t.viewport.offsetWidth<t.viewport.scrollWidth,h=t.viewport.offsetHeight<t.viewport.scrollHeight;l(i?m:h)}},10);return R(t.viewport,d),R(t.content,d),e.jsx(Y,{present:n||a,children:e.jsx(ee,{"data-state":a?"visible":"hidden",...s,ref:o})})}),ee=c.forwardRef((r,o)=>{const{orientation:t="vertical",...n}=r,s=w(j,r.__scopeScrollArea),a=c.useRef(null),l=c.useRef(0),[i,d]=c.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),m=ke(i.viewport,i.content),h={...n,sizes:i,onSizesChange:d,hasThumb:m>0&&m<1,onThumbChange:u=>a.current=u,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:u=>l.current=u};function f(u,x){return br(u,l.current,i,x)}return t==="horizontal"?e.jsx(hr,{...h,ref:o,onThumbPositionChange:()=>{if(s.viewport&&a.current){const u=s.viewport.scrollLeft,x=se(u,i,s.dir);a.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:u=>{s.viewport&&(s.viewport.scrollLeft=u)},onDragScroll:u=>{s.viewport&&(s.viewport.scrollLeft=f(u,s.dir))}}):t==="vertical"?e.jsx(ur,{...h,ref:o,onThumbPositionChange:()=>{if(s.viewport&&a.current){const u=s.viewport.scrollTop,x=se(u,i);a.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:u=>{s.viewport&&(s.viewport.scrollTop=u)},onDragScroll:u=>{s.viewport&&(s.viewport.scrollTop=f(u))}}):null}),hr=c.forwardRef((r,o)=>{const{sizes:t,onSizesChange:n,...s}=r,a=w(j,r.__scopeScrollArea),[l,i]=c.useState(),d=c.useRef(null),m=A(o,d,a.onScrollbarXChange);return c.useEffect(()=>{d.current&&i(getComputedStyle(d.current))},[d]),e.jsx(Re,{"data-orientation":"horizontal",...s,ref:m,sizes:t,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":$(t)+"px",...r.style},onThumbPointerDown:h=>r.onThumbPointerDown(h.x),onDragScroll:h=>r.onDragScroll(h.x),onWheelScroll:(h,f)=>{if(a.viewport){const u=a.viewport.scrollLeft+h.deltaX;r.onWheelScroll(u),De(u,f)&&h.preventDefault()}},onResize:()=>{d.current&&a.viewport&&l&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:H(l.paddingLeft),paddingEnd:H(l.paddingRight)}})}})}),ur=c.forwardRef((r,o)=>{const{sizes:t,onSizesChange:n,...s}=r,a=w(j,r.__scopeScrollArea),[l,i]=c.useState(),d=c.useRef(null),m=A(o,d,a.onScrollbarYChange);return c.useEffect(()=>{d.current&&i(getComputedStyle(d.current))},[d]),e.jsx(Re,{"data-orientation":"vertical",...s,ref:m,sizes:t,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":$(t)+"px",...r.style},onThumbPointerDown:h=>r.onThumbPointerDown(h.y),onDragScroll:h=>r.onDragScroll(h.y),onWheelScroll:(h,f)=>{if(a.viewport){const u=a.viewport.scrollTop+h.deltaY;r.onWheelScroll(u),De(u,f)&&h.preventDefault()}},onResize:()=>{d.current&&a.viewport&&l&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:H(l.paddingTop),paddingEnd:H(l.paddingBottom)}})}})}),[fr,Ee]=Se(j),Re=c.forwardRef((r,o)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:s,onThumbChange:a,onThumbPointerUp:l,onThumbPointerDown:i,onThumbPositionChange:d,onDragScroll:m,onWheelScroll:h,onResize:f,...u}=r,x=w(j,t),[p,y]=c.useState(null),U=A(o,b=>y(b)),S=c.useRef(null),L=c.useRef(""),Q=x.viewport,D=n.content-n.viewport,M=N(h),T=N(d),O=V(f,10);function z(b){if(S.current){const v=b.clientX-S.current.left,P=b.clientY-S.current.top;m({x:v,y:P})}}return c.useEffect(()=>{const b=v=>{const P=v.target;(p==null?void 0:p.contains(P))&&M(v,D)};return document.addEventListener("wheel",b,{passive:!1}),()=>document.removeEventListener("wheel",b,{passive:!1})},[Q,p,D,M]),c.useEffect(T,[n,T]),R(p,O),R(x.content,O),e.jsx(fr,{scope:t,scrollbar:p,hasThumb:s,onThumbChange:N(a),onThumbPointerUp:N(l),onThumbPositionChange:T,onThumbPointerDown:N(i),children:e.jsx(k.div,{...u,ref:U,style:{position:"absolute",...u.style},onPointerDown:C(r.onPointerDown,b=>{b.button===0&&(b.target.setPointerCapture(b.pointerId),S.current=p.getBoundingClientRect(),L.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),z(b))}),onPointerMove:C(r.onPointerMove,z),onPointerUp:C(r.onPointerUp,b=>{const v=b.target;v.hasPointerCapture(b.pointerId)&&v.releasePointerCapture(b.pointerId),document.body.style.webkitUserSelect=L.current,x.viewport&&(x.viewport.style.scrollBehavior=""),S.current=null})})})}),F="ScrollAreaThumb",Ae=c.forwardRef((r,o)=>{const{forceMount:t,...n}=r,s=Ee(F,r.__scopeScrollArea);return e.jsx(Y,{present:t||s.hasThumb,children:e.jsx(xr,{ref:o,...n})})}),xr=c.forwardRef((r,o)=>{const{__scopeScrollArea:t,style:n,...s}=r,a=w(F,t),l=Ee(F,t),{onThumbPositionChange:i}=l,d=A(o,f=>l.onThumbChange(f)),m=c.useRef(void 0),h=V(()=>{m.current&&(m.current(),m.current=void 0)},100);return c.useEffect(()=>{const f=a.viewport;if(f){const u=()=>{if(h(),!m.current){const x=gr(f,i);m.current=x,i()}};return i(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[a.viewport,h,i]),e.jsx(k.div,{"data-state":l.hasThumb?"visible":"hidden",...s,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:C(r.onPointerDownCapture,f=>{const x=f.target.getBoundingClientRect(),p=f.clientX-x.left,y=f.clientY-x.top;l.onThumbPointerDown({x:p,y})}),onPointerUp:C(r.onPointerUp,l.onThumbPointerUp)})});Ae.displayName=F;var re="ScrollAreaCorner",Te=c.forwardRef((r,o)=>{const t=w(re,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?e.jsx(pr,{...r,ref:o}):null});Te.displayName=re;var pr=c.forwardRef((r,o)=>{const{__scopeScrollArea:t,...n}=r,s=w(re,t),[a,l]=c.useState(0),[i,d]=c.useState(0),m=!!(a&&i);return R(s.scrollbarX,()=>{var f;const h=((f=s.scrollbarX)==null?void 0:f.offsetHeight)||0;s.onCornerHeightChange(h),d(h)}),R(s.scrollbarY,()=>{var f;const h=((f=s.scrollbarY)==null?void 0:f.offsetWidth)||0;s.onCornerWidthChange(h),l(h)}),m?e.jsx(k.div,{...n,ref:o,style:{width:a,height:i,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function H(r){return r?parseInt(r,10):0}function ke(r,o){const t=r/o;return isNaN(t)?0:t}function $(r){const o=ke(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*o;return Math.max(n,18)}function br(r,o,t,n="ltr"){const s=$(t),a=s/2,l=o||a,i=s-l,d=t.scrollbar.paddingStart+l,m=t.scrollbar.size-t.scrollbar.paddingEnd-i,h=t.content-t.viewport,f=n==="ltr"?[0,h]:[h*-1,0];return Le([d,m],f)(r)}function se(r,o,t="ltr"){const n=$(o),s=o.scrollbar.paddingStart+o.scrollbar.paddingEnd,a=o.scrollbar.size-s,l=o.content-o.viewport,i=a-n,d=t==="ltr"?[0,l]:[l*-1,0],m=Ke(r,d);return Le([0,l],[0,i])(m)}function Le(r,o){return t=>{if(r[0]===r[1]||o[0]===o[1])return o[0];const n=(o[1]-o[0])/(r[1]-r[0]);return o[0]+n*(t-r[0])}}function De(r,o){return r>0&&r<o}var gr=(r,o=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return function s(){const a={left:r.scrollLeft,top:r.scrollTop},l=t.left!==a.left,i=t.top!==a.top;(l||i)&&o(),t=a,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function V(r,o){const t=N(r),n=c.useRef(0);return c.useEffect(()=>()=>window.clearTimeout(n.current),[]),c.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,o)},[t,o])}function R(r,o){const t=N(o);He(()=>{let n=0;if(r){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return s.observe(r),()=>{window.cancelAnimationFrame(n),s.unobserve(r)}}},[r,t])}var Me=Ne,wr=_e,vr=Te;const Oe=c.forwardRef(({className:r,children:o,...t},n)=>e.jsxs(Me,{ref:n,className:_("relative overflow-hidden",r),...t,children:[e.jsx(wr,{className:"h-full w-full rounded-[inherit]",children:o}),e.jsx(ze,{}),e.jsx(vr,{})]}));Oe.displayName=Me.displayName;const ze=c.forwardRef(({className:r,orientation:o="vertical",...t},n)=>e.jsx(J,{ref:n,orientation:o,className:_("flex touch-none select-none transition-colors",o==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",o==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...t,children:e.jsx(Ae,{className:"relative flex-1 rounded-full bg-border"})}));ze.displayName=J.displayName;const jr=({item:r})=>{const{removeItem:o,updateItemQuantity:t}=W(),{product:n,quantity:s,subtotal:a,notes:l}=r,i=m=>{t(n.id,m)},d=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m);return e.jsxs("div",{className:"flex items-start gap-3 border-b pb-3",children:[e.jsx("img",{src:n.image_url||"/placeholder.svg",alt:n.name,className:"w-16 h-16 object-cover rounded-md flex-shrink-0"}),e.jsxs("div",{className:"flex-grow space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"font-medium text-sm pr-2",children:n.name}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6 flex-shrink-0",onClick:()=>o(n.id),children:e.jsx($e,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n.is_price_by_weight?`${s} kg`:`${s} x ${d(n.price)}`}),l&&e.jsxs("p",{className:"text-xs text-muted-foreground italic max-w-full truncate",children:["Obs: ",l]}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsxs("div",{className:"flex items-center border rounded-md h-8",children:[e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>i(s-1),disabled:s<=(n.is_price_by_weight?.1:1),children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(Z,{type:n.is_price_by_weight?"number":"text",step:n.is_price_by_weight?"0.1":"1",value:n.is_price_by_weight?s.toFixed(1):s,onChange:m=>{const h=parseFloat(m.target.value);h>0&&i(h)},className:"w-12 h-8 text-center border-y-0 rounded-none p-0 focus-visible:ring-0",readOnly:!n.is_price_by_weight}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>i(s+(n.is_price_by_weight?.1:1)),children:e.jsx(q,{className:"h-4 w-4"})})]}),e.jsx("span",{className:"font-bold text-base",children:d(a)})]})]})]})},yr=({totalAmount:r,totalItems:o})=>o===0?null:e.jsxs("div",{className:_("fixed bottom-0 left-0 right-0 bg-card border-t shadow-2xl p-4 z-50","lg:hidden"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Total do Pedido (",o," itens):"]}),e.jsx("span",{className:"text-xl font-bold text-foreground",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r)})]}),e.jsx(ae,{to:"/pre-checkout",children:e.jsxs(g,{className:"w-full h-12 text-lg",children:["Finalizar Pedido ",e.jsx(ve,{className:"ml-2 h-5 w-5"})]})})]}),oe=({isOpen:r=!0,onClose:o})=>{const{items:t,totalAmount:n,totalItems:s}=W(),a=e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("h2",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(E,{className:"h-5 w-5 text-primary"}),"Seu Pedido (",s,")"]})}),t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center flex-grow p-8 text-center",children:[e.jsx(E,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-semibold",children:"Seu carrinho está vazio"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Adicione alguns itens deliciosos!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"flex-grow p-4",children:e.jsx("div",{className:"space-y-4",children:t.map(l=>e.jsx(jr,{item:l},l.product.id))})}),e.jsxs("div",{className:"p-4 border-t space-y-3",children:[e.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n)})]}),e.jsx(ae,{to:"/pre-checkout",onClick:o,children:e.jsxs(g,{className:"w-full h-12 text-lg",children:["Finalizar Pedido ",e.jsx(ve,{className:"ml-2 h-5 w-5"})]})})]})]})]});return r===!0&&!o?e.jsx(me,{className:"shadow-lg h-[calc(100vh-5rem)] flex flex-col",children:a}):e.jsx(Ve,{open:r,onOpenChange:o,children:e.jsxs(Ue,{side:"right",className:"w-full sm:max-w-sm p-0",children:[a,r&&s>0&&e.jsx(yr,{totalAmount:n,totalItems:s})]})})},Sr=async()=>{var d;const{data:r,error:o}=await I.from("restaurants").select("*").eq("is_active",!0).limit(1).single();if(o)throw new Error(`Erro ao buscar restaurante: ${o.message}`);if(!r)throw new Error("Nenhum restaurante ativo encontrado.");const t=r.id,[n,s,a]=await Promise.all([I.from("categories").select("*").eq("restaurant_id",t).eq("is_active",!0).order("display_order",{ascending:!0}),I.from("products").select("*").eq("restaurant_id",t),I.from("business_hours").select("*").eq("restaurant_id",t)]);if(n.error)throw new Error(`Erro ao buscar categorias: ${n.error.message}`);if(s.error)throw new Error(`Erro ao buscar produtos: ${s.error.message}`);a.error&&console.warn("Aviso: Erro ao buscar horários de funcionamento:",a.error.message);const l=new Map;(d=s.data)==null||d.forEach(m=>{if(m.category_id){const h=l.get(m.category_id)||[];h.push(m),l.set(m.category_id,h)}});const i=n.data.map(m=>({...m,products:l.get(m.id)||[]})).filter(m=>m.products.length>0);return{restaurant:r,categories:i,hours:a.data||[]}},Vr=()=>{const r=Qe(),{totalItems:o}=W(),[t,n]=c.useState(!1),{data:s,isLoading:a,isError:l,error:i,refetch:d}=Ie({queryKey:["menuData"],queryFn:Sr,staleTime:1e3*60*5}),{isOpen:m,todayHours:h}=c.useMemo(()=>s!=null&&s.hours?ye(s.hours):{isOpen:!0,todayHours:"Horário não configurado"},[s==null?void 0:s.hours]);if(a)return e.jsx(Be,{});if(l||!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(le,{variant:"destructive",className:"max-w-lg",children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsx(ie,{children:"Erro ao carregar cardápio"}),e.jsx(ce,{children:i instanceof Error?i.message:"Ocorreu um erro desconhecido ao buscar os dados do restaurante."}),e.jsxs(Button,{onClick:()=>d(),className:"mt-3",variant:"secondary",size:"sm",children:[e.jsx(RefreshCw,{className:"h-4 w-4 mr-2"})," Tentar Novamente"]})]})});const{restaurant:f,categories:u}=s;return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx("header",{className:"border-b bg-card sticky top-0 z-30 shadow-sm",children:e.jsxs("div",{className:"container mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-xl font-bold",children:f.name})]}),r&&o>0&&e.jsx(lr,{onClick:()=>n(!0),totalItems:o})]}),e.jsx("div",{className:"mt-3",children:e.jsx(rr,{restaurant:f,hours:s.hours})})]})}),e.jsxs("main",{className:"flex-1 container mx-auto px-4 py-8 flex",children:[e.jsxs("div",{className:"flex-1 max-w-full lg:max-w-3xl xl:max-w-4xl",children:[!m&&e.jsx(tr,{todayHours:h}),e.jsx("div",{className:"space-y-10",children:u.map(x=>e.jsxs("section",{id:`category-${x.id}`,className:"scroll-mt-20",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 border-b pb-2",children:x.name}),e.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:x.products.filter(p=>p.is_available).map(p=>e.jsx(ar,{product:p},p.id))}),x.products.filter(p=>p.is_available).length===0&&e.jsx("p",{className:"text-muted-foreground",children:"Nenhum produto disponível nesta categoria."})]},x.id))})]}),e.jsx("div",{className:"hidden lg:block lg:w-96 lg:ml-8 flex-shrink-0 sticky top-20 self-start",children:e.jsx(oe,{})})]}),r&&e.jsx(oe,{isOpen:t,onClose:()=>n(!1)})]})};export{Vr as default};
