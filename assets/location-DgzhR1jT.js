const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./GoogleMapComponent-D-CWO3tH.js","./tanstack-d4AvmB45.js","./vendor-CnEXr6gt.js","./index-dL3gbIx1.js","./supabase-BZV_3FV3.js","./index-Dcexqmok.css"])))=>i.map(i=>d[i]);
import{j as g}from"./tanstack-d4AvmB45.js";import{R as L,r as p}from"./vendor-CnEXr6gt.js";import{I as y}from"./label-Dcotrb99.js";import{a as E,b as v,u as G}from"./index-dL3gbIx1.js";import{_ as O}from"./supabase-BZV_3FV3.js";const P=s=>{let o=s.replace(/\D/g,"");return o.length>8&&(o=o.slice(0,8)),o.length>5&&(o=`${o.slice(0,5)}-${o.slice(5)}`),o},_=L.forwardRef(({className:s,value:o,onChange:n,...r},a)=>{const e=t=>{const c=t.target.value,l=P(c),i={...t,target:{...t.target,value:l}};n(i)};return g.jsx(y,{ref:a,type:"tel",className:E("w-full",s),placeholder:"00000-000",value:o,onChange:e,maxLength:9,...r})});_.displayName="ZipCodeInput";const b=p.lazy(()=>O(()=>import("./GoogleMapComponent-D-CWO3tH.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url).then(s=>({default:s.GoogleMapComponent}))),F=s=>{const{center:o,markerPosition:n,onMarkerDragEnd:r,zoom:a}=s,e=p.useMemo(()=>({lat:o[0],lng:o[1]}),[o]),t=p.useMemo(()=>({lat:n[0],lng:n[1]}),[n]);return g.jsx(p.Suspense,{fallback:g.jsx(v,{}),children:g.jsx(b,{center:e,markerPosition:t,onMarkerDragEnd:r,zoom:a})})},R=(s,o,n,r)=>{const e=(n-s)*(Math.PI/180),t=(r-o)*(Math.PI/180),c=Math.sin(e/2)*Math.sin(e/2)+Math.cos(s*(Math.PI/180))*Math.cos(n*(Math.PI/180))*Math.sin(t/2)*Math.sin(t/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},k=async s=>{const o=s.replace(/\s+/g," ").trim(),n="AIzaSyDLbTHiIeHXH690Tqvr_W5OgzX-XGgYcgY",r=new AbortController,a=setTimeout(()=>r.abort(),1e4);try{let e,t="Nominatim";if(n){t="Google Maps Geocoding";const i=o.split(",").map(u=>u.trim()),d=i[i.length-1],m=/^\d{5}-?\d{3}$/.test(d.replace(/\s/g,""));let M=o;m&&i.length>1&&(M=i.slice(0,i.length-1).join(", "));const I=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(M)}&components=country:BR&key=${n}`;console.log("LOG: geocodeAddress - URL da API (Google):",I);const h=await fetch(I,{signal:r.signal});if(!h.ok)console.error("LOG: geocodeAddress (Google) - Resposta da API não OK. Status:",h.status);else{if(e=await h.json(),e.status==="REQUEST_DENIED"&&console.error("LOG: Google Maps Geocoding API retornou REQUEST_DENIED. Verifique se a 'Geocoding API' está ativada e se as restrições da chave estão corretas."),e.status==="OK"&&e.results&&e.results.length>0){const u=e.results[0].geometry.location,f=u.lat,A=u.lng;if(Number.isFinite(f)&&Number.isFinite(A))return console.log(`LOG: geocodeAddress (${t}) - Geocodificação bem-sucedida. Coordenadas:`,[f,A]),clearTimeout(a),{lat:f,lng:A}}console.warn(`LOG: geocodeAddress (Google) - Falha na busca. Status: ${e.status}. Tentando Nominatim.`)}}t="Nominatim";const c=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(o)}&limit=1&addressdetails=1`;console.log("LOG: geocodeAddress - URL da API (Nominatim):",c);const l=await fetch(c,{signal:r.signal,headers:{"User-Agent":"Pedido123-App/1.0 (https://juniorsampaiobr-code.github.io/pedido123new/)"}});if(!l.ok)return console.error("LOG: geocodeAddress (Nominatim) - Resposta da API não OK. Status:",l.status),null;if(e=await l.json(),e&&Array.isArray(e)&&e.length>0){const i=e[0],d=parseFloat(i.lat),m=parseFloat(i.lon);if(Number.isFinite(d)&&Number.isFinite(m))return console.log(`LOG: geocodeAddress (${t}) - Geocodificação bem-sucedida. Coordenadas:`,[d,m]),clearTimeout(a),{lat:d,lng:m}}return console.warn("LOG: geocodeAddress - Falha. Nenhum resultado encontrado ou coordenadas inválidas para:",o),G.error("Não foi possível encontrar o endereço. Verifique todos os campos e tente novamente."),null}catch(e){return e instanceof Error&&e.name==="AbortError"?(console.error("LOG: geocodeAddress - Timeout na requisição (10s). Endereço:",o),G.error("A requisição para encontrar o endereço demorou muito. Tente novamente.")):(console.error("LOG: geocodeAddress - Erro durante a requisição:",e),G.error("Ocorreu um erro ao buscar o endereço. Tente novamente.")),null}finally{clearTimeout(a)}},w=(s,o,n)=>{const r=R(o[0],o[1],s[0],s[1]),a=n.find(e=>r<=e.max_distance_km);if(a){const e=a.delivery_fee||0,t=a.min_delivery_time_minutes||0,c=t+15;return{fee:parseFloat(e.toFixed(2)),minTime:t,maxTime:c}}return null};export{F as L,_ as Z,w as c,k as g};
