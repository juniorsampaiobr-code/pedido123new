const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./GoogleMapComponent-C7EFE1ZW.js","./tanstack-d4AvmB45.js","./vendor-CnEXr6gt.js","./index-CIiREe9i.js","./supabase-BZV_3FV3.js","./index-Dcexqmok.css"])))=>i.map(i=>d[i]);
import{j as d}from"./tanstack-d4AvmB45.js";import{R as g,r as m}from"./vendor-CnEXr6gt.js";import{I as h}from"./label-C4ZLOv74.js";import{a as f,b as M,u as p}from"./index-CIiREe9i.js";import{_ as A}from"./supabase-BZV_3FV3.js";const v=t=>{let e=t.replace(/\D/g,"");return e.length>8&&(e=e.slice(0,8)),e.length>5&&(e=`${e.slice(0,5)}-${e.slice(5)}`),e},x=g.forwardRef(({className:t,value:e,onChange:n,...i},s)=>{const r=o=>{const a=o.target.value,c=v(a),l={...o,target:{...o.target,value:c}};n(l)};return d.jsx(h,{ref:s,type:"tel",className:f("w-full",t),placeholder:"00000-000",value:e,onChange:r,maxLength:9,...i})});x.displayName="ZipCodeInput";const y=m.lazy(()=>A(()=>import("./GoogleMapComponent-C7EFE1ZW.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url).then(t=>({default:t.GoogleMapComponent}))),E=t=>{const{center:e,markerPosition:n,onMarkerDragEnd:i,zoom:s}=t,r=m.useMemo(()=>({lat:e[0],lng:e[1]}),[e]),o=m.useMemo(()=>({lat:n[0],lng:n[1]}),[n]);return d.jsx(m.Suspense,{fallback:d.jsx(M,{}),children:d.jsx(y,{center:r,markerPosition:o,onMarkerDragEnd:i,zoom:s})})},L=(t,e,n,i)=>{const r=(n-t)*(Math.PI/180),o=(i-e)*(Math.PI/180),a=Math.sin(r/2)*Math.sin(r/2)+Math.cos(t*(Math.PI/180))*Math.cos(n*(Math.PI/180))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))},R=async(t,e)=>{const n=t.replace(/\s+/g," ").trim(),i=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(n)}&limit=1&addressdetails=1`,s=new AbortController,r=setTimeout(()=>s.abort(),1e4);try{console.log("LOG: geocodeAddress - URL da API:",i);const o=await fetch(i,{signal:s.signal,headers:{"User-Agent":"Pedido123-App/1.0 (https://juniorsampaiobr-code.github.io/pedido123new/)"}});if(!o.ok)return console.error("LOG: geocodeAddress - Resposta da API não OK. Status:",o.status),null;const a=await o.json();if(a&&Array.isArray(a)&&a.length>0){const c=a[0],l=parseFloat(c.lat),u=parseFloat(c.lon);if(Number.isFinite(l)&&Number.isFinite(u))return console.log("LOG: geocodeAddress - Geocodificação bem-sucedida. Coordenadas:",[l,u]),{lat:l,lng:u}}return console.warn("LOG: geocodeAddress - Falha. Nenhum resultado encontrado ou coordenadas inválidas para:",n),p.error("Não foi possível encontrar o endereço. Verifique todos os campos e tente novamente."),null}catch(o){return o instanceof Error&&o.name==="AbortError"?(console.error("LOG: geocodeAddress - Timeout na requisição (10s). Endereço:",n),p.error("A requisição para encontrar o endereço demorou muito. Tente novamente.")):(console.error("LOG: geocodeAddress - Erro durante a requisição:",o),p.error("Ocorreu um erro ao buscar o endereço. Tente novamente.")),null}finally{clearTimeout(r)}},j=(t,e,n)=>{const i=L(e[0],e[1],t[0],t[1]),s=n.find(r=>i<=r.max_distance_km);if(s){const r=s.delivery_fee||0,o=s.min_delivery_time_minutes||0,a=o+15;return{fee:parseFloat(r.toFixed(2)),minTime:o,maxTime:a}}return null};export{E as L,x as Z,j as c,R as g};
