import{b as k,j as e}from"./tanstack-d4AvmB45.js";import{B as N}from"./button-CZnjig79.js";import{C as x,b as h,c as p,a as f}from"./card-BZMFC2Ow.js";import{c as l,u as w}from"./index-B9YycQFT.js";import{s as d}from"./client-D5i5GwB9.js";import{f as m}from"./format-BeKxgCCE.js";import{S as M}from"./skeleton-DsKvXCO8.js";import{i as L}from"./vendor-CnEXr6gt.js";import{S as D}from"./shopping-cart-6XgIzKvh.js";import{P as E}from"./package-8pVFAwNP.js";import"./supabase-BZV_3FV3.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=l("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=l("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=l("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=l("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),P=async t=>{var v;const a=m(new Date,"yyyy-MM-dd"),r=m(new Date(new Date().getFullYear(),new Date().getMonth(),1),"yyyy-MM-dd"),{count:s,error:o}=await d.from("products").select("id",{count:"exact",head:!0}).eq("restaurant_id",t);o&&console.error("Error fetching products count:",o);const{count:u,error:n}=await d.from("customers").select("id",{count:"exact",head:!0}).eq("user_id",(v=d.auth.currentUser)==null?void 0:v.id);n&&console.error("Error fetching customers count:",n);const{data:j,error:y}=await d.from("orders").select("created_at, total_amount, status").eq("restaurant_id",t).gte("created_at",r).in("status",["delivered","preparing","ready","delivering","pending"]);y&&console.error("Error fetching orders data:",y);let g=0,C=0;return j&&j.forEach(i=>{const b=m(new Date(i.created_at),"yyyy-MM-dd");i.status!=="cancelled"&&(C+=i.total_amount),b===a&&i.status!=="cancelled"&&g++}),{productsCount:s||0,customersCount:u||0,ordersTodayCount:g,salesMonthTotal:C}},z=t=>k({queryKey:["dashboardStats",t],queryFn:()=>P(t),enabled:!!t,initialData:{productsCount:0,customersCount:0,ordersTodayCount:0,salesMonthTotal:0},staleTime:1e3*60*5}),c=({icon:t,title:a,value:r,description:s,isLoading:o})=>e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:a}),e.jsx(t,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(f,{children:[o?e.jsx(M,{className:"h-7 w-3/4"}):e.jsx("div",{className:"text-2xl font-bold",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s})]})]}),Y=()=>{const{restaurant:t}=L(),a=`${window.location.origin}${window.location.pathname}#/menu/${t.id}`,{data:r,isLoading:s}=z(t.id),o=()=>{navigator.clipboard.writeText(a),w.success("Link copiado para a área de transferência!")},u=n=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n);return e.jsxs("main",{className:"flex-1 p-4 sm:p-6 md:p-8 space-y-8",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Bem-vindo ao painel de controle do Pedido 123"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(c,{title:"Pedidos Hoje",value:s?"":String(r.ordersTodayCount),description:s?"Carregando...":r.ordersTodayCount===0?"Nenhum pedido hoje":`${r.ordersTodayCount} pedidos`,icon:D,isLoading:s}),e.jsx(c,{title:"Produtos",value:s?"":String(r.productsCount),description:s?"Carregando...":"Total de produtos",icon:E,isLoading:s}),e.jsx(c,{title:"Vendas do Mês",value:s?"":u(r.salesMonthTotal),description:s?"Carregando...":"Receita mensal",icon:T,isLoading:s}),e.jsx(c,{title:"Clientes",value:s?"":String(r.customersCount),description:s?"Carregando...":"Total de clientes",icon:_,isLoading:s})]}),e.jsxs("div",{className:"grid gap-8 lg:grid-cols-2",children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(p,{children:"Primeiros Passos"})}),e.jsxs(f,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary text-primary-foreground font-bold flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Configure sua loja"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Adicione informações sobre seu restaurante ou estabelecimento"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary text-primary-foreground font-bold flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Cadastre seus produtos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Crie categorias e adicione os produtos do seu cardápio"})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary text-primary-foreground font-bold flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"semibold",children:"Compartilhe seu link"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Envie o link da sua loja para seus clientes começarem a fazer pedidos"})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(p,{children:"Compartilhe seu Link"}),e.jsx("p",{className:"text-sm text-muted-foreground pt-1",children:"Envie este link para seus clientes fazerem pedidos"})]}),e.jsxs(f,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1 bg-muted rounded-md px-3 py-2 text-sm text-muted-foreground overflow-x-auto whitespace-nowrap",children:a}),e.jsx(N,{variant:"outline",size:"icon",onClick:o,children:e.jsx(S,{className:"h-4 w-4"})}),e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:e.jsx(N,{variant:"outline",size:"icon",children:e.jsx(q,{className:"h-4 w-4"})})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Este é o link exclusivo do seu restaurante: ",e.jsx("span",{className:"font-semibold",children:t.name})]})]})]})]})]})};export{Y as default};
